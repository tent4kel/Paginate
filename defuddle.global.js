var Defuddle=(()=>{var tt=Object.create;var Z=Object.defineProperty;var et=Object.getOwnPropertyDescriptor;var rt=Object.getOwnPropertyNames;var ot=Object.getPrototypeOf,nt=Object.prototype.hasOwnProperty;var it=(U,F)=>()=>(F||U((F={exports:{}}).exports,F),F.exports);var at=(U,F,G,z)=>{if(F&&typeof F=="object"||typeof F=="function")for(let I of rt(F))!nt.call(U,I)&&I!==G&&Z(U,I,{get:()=>F[I],enumerable:!(z=et(F,I))||z.enumerable});return U};var st=(U,F,G)=>(G=U!=null?tt(ot(U)):{},at(F||!U||!U.__esModule?Z(G,"default",{value:U,enumerable:!0}):G,U));var Q=it((Y,K)=>{(function(U,F){typeof Y=="object"&&typeof K=="object"?K.exports=F():typeof define=="function"&&define.amd?define([],F):typeof Y=="object"?Y.Defuddle=F():U.Defuddle=F()})(typeof self<"u"?self:Y,(()=>(()=>{"use strict";var U={0:(I,g,m)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.mathRules=g.createCleanMathEl=void 0;let f=m(282);g.createCleanMathEl=(p,w,t,o)=>{let r=p.createElement("math");if(r.setAttribute("xmlns","http://www.w3.org/1998/Math/MathML"),r.setAttribute("display",o?"block":"inline"),r.setAttribute("data-latex",t||""),w?.mathml){let e=p.createElement("div");e.innerHTML=w.mathml;let n=e.querySelector("math");n&&(r.innerHTML=n.innerHTML)}else t&&(r.textContent=t);return r},g.mathRules=[{selector:f.mathSelectors,element:"math",transform:(p,w)=>{if(!(function(n){return"classList"in n&&"getAttribute"in n&&"querySelector"in n})(p))return p;let t=(0,f.getMathMLFromElement)(p),o=(0,f.getBasicLatexFromElement)(p),r=(0,f.isBlockDisplay)(p),e=(0,g.createCleanMathEl)(w,t,o,r);return p.parentElement&&p.parentElement.querySelectorAll(`
					/* MathJax scripts and previews */
					script[type^="math/"],
					.MathJax_Preview,

					/* External math library scripts */
					script[type="text/javascript"][src*="mathjax"],
					script[type="text/javascript"][src*="katex"]
				`).forEach((n=>n.remove())),e}}]},20:(I,g,m)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.GrokExtractor=void 0;let f=m(181);class p extends f.ConversationExtractor{constructor(t,o){super(t,o),this.messageContainerSelector=".relative.group.flex.flex-col.justify-center.w-full",this.messageBubbles=t.querySelectorAll(this.messageContainerSelector),this.footnotes=[],this.footnoteCounter=0}canExtract(){return!!this.messageBubbles&&this.messageBubbles.length>0}extractMessages(){let t=[];return this.footnotes=[],this.footnoteCounter=0,this.messageBubbles&&this.messageBubbles.length!==0&&this.messageBubbles.forEach((o=>{var r;let e=o.classList.contains("items-end"),n=o.classList.contains("items-start");if(!e&&!n)return;let i=o.querySelector(".message-bubble");if(!i)return;let a="",l="",c="";if(e)a=i.textContent||"",l="user",c="You";else if(n){l="assistant",c="Grok";let u=i.cloneNode(!0);(r=u.querySelector(".relative.border.border-border-l1.bg-surface-base"))===null||r===void 0||r.remove(),a=u.innerHTML,a=this.processFootnotes(a)}a.trim()&&t.push({author:c,content:a.trim(),metadata:{role:l}})})),t}getFootnotes(){return this.footnotes}getMetadata(){var t;let o=this.getTitle(),r=((t=this.messageBubbles)===null||t===void 0?void 0:t.length)||0;return{title:o,site:"Grok",url:this.url,messageCount:r,description:`Grok conversation with ${r} messages`}}getTitle(){var t,o;let r=(t=this.document.title)===null||t===void 0?void 0:t.trim();if(r&&r!=="Grok"&&!r.startsWith("Grok by "))return r.replace(/\s-\s*Grok$/,"").trim();let e=this.document.querySelector(`${this.messageContainerSelector}.items-end`);if(e){let n=e.querySelector(".message-bubble");if(n){let i=((o=n.textContent)===null||o===void 0?void 0:o.trim())||"";return i.length>50?i.slice(0,50)+"...":i}}return"Grok Conversation"}processFootnotes(t){return t.replace(/<a\s+(?:[^>]*?\s+)?href="([^"]*)"[^>]*>(.*?)<\/a>/gi,((o,r,e)=>{if(!r||r.startsWith("#")||!r.match(/^https?:\/\//i))return o;let n;if(this.footnotes.find((i=>i.url===r)))n=this.footnotes.findIndex((i=>i.url===r))+1;else{this.footnoteCounter++,n=this.footnoteCounter;let i=r;try{let a=new URL(r).hostname.replace(/^www\./,"");i=`<a href="${r}" target="_blank" rel="noopener noreferrer">${a}</a>`}catch{i=`<a href="${r}" target="_blank" rel="noopener noreferrer">${r}</a>`,console.warn(`GrokExtractor: Could not parse URL for footnote: ${r}`)}this.footnotes.push({url:r,text:i})}return`${e}<sup id="fnref:${n}" class="footnote-ref"><a href="#fn:${n}" class="footnote-link">${n}</a></sup>`}))}}g.GrokExtractor=p},181:(I,g,m)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.ConversationExtractor=void 0;let f=m(279),p=m(628);class w extends f.BaseExtractor{getFootnotes(){return[]}extract(){var o;let r=this.extractMessages(),e=this.getMetadata(),n=this.getFootnotes(),i=this.createContentHtml(r,n),a=document.implementation.createHTMLDocument(),l=a.createElement("article");l.innerHTML=i,a.body.appendChild(l);let c=new p.Defuddle(a).parse(),u=c.content;return{content:u,contentHtml:u,extractedContent:{messageCount:r.length.toString()},variables:{title:e.title||"Conversation",site:e.site,description:e.description||`${e.site} conversation with ${r.length} messages`,wordCount:((o=c.wordCount)===null||o===void 0?void 0:o.toString())||""}}}createContentHtml(o,r){return`${o.map(((e,n)=>{let i=e.timestamp?`<div class="message-timestamp">${e.timestamp}</div>`:"",a=/<p[^>]*>[\s\S]*?<\/p>/i.test(e.content)?e.content:`<p>${e.content}</p>`,l=e.metadata?Object.entries(e.metadata).map((([c,u])=>`data-${c}="${u}"`)).join(" "):"";return`
			<div class="message message-${e.author.toLowerCase()}" ${l}>
				<div class="message-header">
					<p class="message-author"><strong>${e.author}</strong></p>
					${i}
				</div>
				<div class="message-content">
					${a}
				</div>
			</div>${n<o.length-1?`
<hr>`:""}`})).join(`
`).trim()}
${r.length>0?`
			<div id="footnotes">
				<ol>
					${r.map(((e,n)=>`
						<li class="footnote" id="fn:${n+1}">
							<p>
								<a href="${e.url}" target="_blank">${e.text}</a>&nbsp;<a href="#fnref:${n+1}" class="footnote-backref">\u21A9</a>
							</p>
						</li>
					`)).join("")}
				</ol>
			</div>`:""}`.trim()}}g.ConversationExtractor=w},248:(I,g,m)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.TwitterExtractor=void 0;let f=m(279);class p extends f.BaseExtractor{constructor(t,o){var r;super(t,o),this.mainTweet=null,this.threadTweets=[];let e=t.querySelector('[aria-label="Timeline: Conversation"]');if(!e){let a=t.querySelector('article[data-testid="tweet"]');return void(a&&(this.mainTweet=a))}let n=Array.from(e.querySelectorAll('article[data-testid="tweet"]')),i=(r=e.querySelector("section, h2"))===null||r===void 0?void 0:r.parentElement;i&&n.forEach(((a,l)=>{if(i.compareDocumentPosition(a)&Node.DOCUMENT_POSITION_FOLLOWING)return n.splice(l),!1})),this.mainTweet=n[0]||null,this.threadTweets=n.slice(1)}canExtract(){return!!this.mainTweet}extract(){let t=this.extractTweet(this.mainTweet),o=this.threadTweets.map((i=>this.extractTweet(i))).join(`
<hr>
`),r=`
			<div class="tweet-thread">
				<div class="main-tweet">
					${t}
				</div>
				${o?`
					<hr>
					<div class="thread-tweets">
						${o}
					</div>
				`:""}
			</div>
		`.trim(),e=this.getTweetId(),n=this.getTweetAuthor();return{content:r,contentHtml:r,extractedContent:{tweetId:e,tweetAuthor:n},variables:{title:`Thread by ${n}`,author:n,site:"X (Twitter)",description:this.createDescription(this.mainTweet)}}}formatTweetText(t){if(!t)return"";let o=this.document.createElement("div");return o.innerHTML=t,o.querySelectorAll("a").forEach((r=>{var e;let n=((e=r.textContent)===null||e===void 0?void 0:e.trim())||"";r.replaceWith(n)})),o.querySelectorAll("span, div").forEach((r=>{r.replaceWith(...Array.from(r.childNodes))})),o.innerHTML.split(`
`).map((r=>r.trim())).filter((r=>r)).map((r=>`<p>${r}</p>`)).join(`
`)}extractTweet(t){var o,r,e;if(!t)return"";let n=t.cloneNode(!0);n.querySelectorAll('img[src*="/emoji/"]').forEach((d=>{if(d.tagName.toLowerCase()==="img"&&d.getAttribute("alt")){let b=d.getAttribute("alt");b&&d.replaceWith(b)}}));let i=((o=n.querySelector('[data-testid="tweetText"]'))===null||o===void 0?void 0:o.innerHTML)||"",a=this.formatTweetText(i),l=this.extractImages(t),c=this.extractUserInfo(t),u=(e=(r=t.querySelector('[aria-labelledby*="id__"]'))===null||r===void 0?void 0:r.querySelector('[data-testid="User-Name"]'))===null||e===void 0?void 0:e.closest('[aria-labelledby*="id__"]'),v=u?this.extractTweet(u):"";return`
			<div class="tweet">
				<div class="tweet-header">
					<span class="tweet-author"><strong>${c.fullName}</strong> <span class="tweet-handle">${c.handle}</span></span>
					${c.date?`<a href="${c.permalink}" class="tweet-date">${c.date}</a>`:""}
				</div>
				${a?`<div class="tweet-text">${a}</div>`:""}
				${l.length?`
					<div class="tweet-media">
						${l.join(`
`)}
					</div>
				`:""}
				${v?`
					<blockquote class="quoted-tweet">
						${v}
					</blockquote>
				`:""}
			</div>
		`.trim()}extractUserInfo(t){var o,r,e,n,i,a,l,c,u;let v=t.querySelector('[data-testid="User-Name"]');if(!v)return{fullName:"",handle:"",date:"",permalink:""};let d=v.querySelectorAll("a"),b=((r=(o=d?.[0])===null||o===void 0?void 0:o.textContent)===null||r===void 0?void 0:r.trim())||"",h=((n=(e=d?.[1])===null||e===void 0?void 0:e.textContent)===null||n===void 0?void 0:n.trim())||"";b&&h||(b=((a=(i=v.querySelector('span[style*="color: rgb(15, 20, 25)"] span'))===null||i===void 0?void 0:i.textContent)===null||a===void 0?void 0:a.trim())||"",h=((c=(l=v.querySelector('span[style*="color: rgb(83, 100, 113)"]'))===null||l===void 0?void 0:l.textContent)===null||c===void 0?void 0:c.trim())||"");let C=t.querySelector("time"),E=C?.getAttribute("datetime")||"";return{fullName:b,handle:h,date:E?new Date(E).toISOString().split("T")[0]:"",permalink:((u=C?.closest("a"))===null||u===void 0?void 0:u.href)||""}}extractImages(t){var o,r;let e=['[data-testid="tweetPhoto"]','[data-testid="tweet-image"]','img[src*="media"]'],n=[],i=(r=(o=t.querySelector('[aria-labelledby*="id__"]'))===null||o===void 0?void 0:o.querySelector('[data-testid="User-Name"]'))===null||r===void 0?void 0:r.closest('[aria-labelledby*="id__"]');for(let a of e)t.querySelectorAll(a).forEach((l=>{var c,u;if(!i?.contains(l)&&l.tagName.toLowerCase()==="img"&&l.getAttribute("alt")){let v=((c=l.getAttribute("src"))===null||c===void 0?void 0:c.replace(/&name=\w+$/,"&name=large"))||"",d=((u=l.getAttribute("alt"))===null||u===void 0?void 0:u.replace(/\s+/g," ").trim())||"";n.push(`<img src="${v}" alt="${d}" />`)}}));return n}getTweetId(){let t=this.url.match(/status\/(\d+)/);return t?.[1]||""}getTweetAuthor(){var t,o,r;let e=(t=this.mainTweet)===null||t===void 0?void 0:t.querySelector('[data-testid="User-Name"]'),n=e?.querySelectorAll("a"),i=((r=(o=n?.[1])===null||o===void 0?void 0:o.textContent)===null||r===void 0?void 0:r.trim())||"";return i.startsWith("@")?i:`@${i}`}createDescription(t){var o;return t?(((o=t.querySelector('[data-testid="tweetText"]'))===null||o===void 0?void 0:o.textContent)||"").trim().slice(0,140).replace(/\s+/g," "):""}}g.TwitterExtractor=p},258:(I,g,m)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.YoutubeExtractor=void 0;let f=m(279);class p extends f.BaseExtractor{constructor(t,o,r){super(t,o,r),this.videoElement=t.querySelector("video"),this.schemaOrgData=r}canExtract(){return!0}extract(){let t=this.getVideoData(),o=t.description||"",r=this.formatDescription(o),e=`<iframe width="560" height="315" src="https://www.youtube.com/embed/${this.getVideoId()}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe><br>${r}`;return{content:e,contentHtml:e,extractedContent:{videoId:this.getVideoId(),author:t.author||""},variables:{title:t.name||"",author:t.author||"",site:"YouTube",image:Array.isArray(t.thumbnailUrl)&&t.thumbnailUrl[0]||"",published:t.uploadDate,description:o.slice(0,200).trim()}}}formatDescription(t){return`<p>${t.replace(/\n/g,"<br>")}</p>`}getVideoData(){return this.schemaOrgData?(Array.isArray(this.schemaOrgData)?this.schemaOrgData.find((t=>t["@type"]==="VideoObject")):this.schemaOrgData["@type"]==="VideoObject"?this.schemaOrgData:null)||{}:{}}getVideoId(){let t=new URL(this.url);return t.hostname==="youtu.be"?t.pathname.slice(1):new URLSearchParams(t.search).get("v")||""}}g.YoutubeExtractor=p},279:(I,g)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.BaseExtractor=void 0,g.BaseExtractor=class{constructor(m,f,p){this.document=m,this.url=f,this.schemaOrgData=p}}},282:(I,g)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.mathSelectors=g.isBlockDisplay=g.getBasicLatexFromElement=g.getMathMLFromElement=void 0,g.getMathMLFromElement=m=>{if(m.tagName.toLowerCase()==="math"){let t=m.getAttribute("display")==="block";return{mathml:m.outerHTML,latex:m.getAttribute("alttext")||null,isBlock:t}}let f=m.getAttribute("data-mathml");if(f){let t=document.createElement("div");t.innerHTML=f;let o=t.querySelector("math");if(o){let r=o.getAttribute("display")==="block";return{mathml:o.outerHTML,latex:o.getAttribute("alttext")||null,isBlock:r}}}let p=m.querySelector(".MJX_Assistive_MathML, mjx-assistive-mml");if(p){let t=p.querySelector("math");if(t){let o=t.getAttribute("display"),r=p.getAttribute("display"),e=o==="block"||r==="block";return{mathml:t.outerHTML,latex:t.getAttribute("alttext")||null,isBlock:e}}}let w=m.querySelector(".katex-mathml math");return w?{mathml:w.outerHTML,latex:null,isBlock:!1}:null},g.getBasicLatexFromElement=m=>{var f,p,w;let t=m.getAttribute("data-latex");if(t)return t;if(m.tagName.toLowerCase()==="img"&&m.classList.contains("latex")){let r=m.getAttribute("alt");if(r)return r;let e=m.getAttribute("src");if(e){let n=e.match(/latex\.php\?latex=([^&]+)/);if(n)return decodeURIComponent(n[1]).replace(/\+/g," ").replace(/%5C/g,"\\")}}let o=m.querySelector('annotation[encoding="application/x-tex"]');if(o?.textContent)return o.textContent.trim();if(m.matches(".katex")){let r=m.querySelector('.katex-mathml annotation[encoding="application/x-tex"]');if(r?.textContent)return r.textContent.trim()}if(m.matches('script[type="math/tex"]')||m.matches('script[type="math/tex; mode=display"]'))return((f=m.textContent)===null||f===void 0?void 0:f.trim())||null;if(m.parentElement){let r=m.parentElement.querySelector('script[type="math/tex"], script[type="math/tex; mode=display"]');if(r)return((p=r.textContent)===null||p===void 0?void 0:p.trim())||null}return m.getAttribute("alt")||((w=m.textContent)===null||w===void 0?void 0:w.trim())||null},g.isBlockDisplay=m=>{if(m.getAttribute("display")==="block")return!0;let f=m.className.toLowerCase();if(f.includes("display")||f.includes("block")||m.closest('.katex-display, .MathJax_Display, [data-display="block"]'))return!0;let p=m.previousElementSibling;if(p?.tagName.toLowerCase()==="p"||m.matches(".mwe-math-fallback-image-display"))return!0;if(m.matches(".katex"))return m.closest(".katex-display")!==null;if(m.hasAttribute("display"))return m.getAttribute("display")==="true";if(m.matches('script[type="math/tex; mode=display"]'))return!0;if(m.hasAttribute("display"))return m.getAttribute("display")==="true";let w=m.closest("[display]");return!!w&&w.getAttribute("display")==="true"},g.mathSelectors=['img.latex[src*="latex.php"]',"span.MathJax","mjx-container",'script[type="math/tex"]','script[type="math/tex; mode=display"]','.MathJax_Preview + script[type="math/tex"]',".MathJax_Display",".MathJax_SVG",".MathJax_MathML",".mwe-math-element",".mwe-math-fallback-image-inline",".mwe-math-fallback-image-display",".mwe-math-mathml-inline",".mwe-math-mathml-display",".katex",".katex-display",".katex-mathml",".katex-html","[data-katex]",'script[type="math/katex"]',"math","[data-math]","[data-latex]","[data-tex]",'script[type^="math/"]','annotation[encoding="application/x-tex"]'].join(",")},397:(I,g,m)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.ClaudeExtractor=void 0;let f=m(181);class p extends f.ConversationExtractor{constructor(t,o){super(t,o),this.articles=t.querySelectorAll('div[data-testid="user-message"], div[data-testid="assistant-message"], div.font-claude-message')}canExtract(){return!!this.articles&&this.articles.length>0}extractMessages(){let t=[];return this.articles&&this.articles.forEach((o=>{let r,e;if(o.hasAttribute("data-testid")){if(o.getAttribute("data-testid")!=="user-message")return;r="you",e=o.innerHTML}else{if(!o.classList.contains("font-claude-message"))return;r="assistant",e=o.innerHTML}e&&t.push({author:r==="you"?"You":"Claude",content:e.trim(),metadata:{role:r}})})),t}getMetadata(){let t=this.getTitle(),o=this.extractMessages();return{title:t,site:"Claude",url:this.url,messageCount:o.length,description:`Claude conversation with ${o.length} messages`}}getTitle(){var t,o,r,e,n;let i=(t=this.document.title)===null||t===void 0?void 0:t.trim();if(i&&i!=="Claude")return i.replace(/ - Claude$/,"");let a=(r=(o=this.document.querySelector("header .font-tiempos"))===null||o===void 0?void 0:o.textContent)===null||r===void 0?void 0:r.trim();if(a)return a;let l=(n=(e=this.articles)===null||e===void 0?void 0:e.item(0))===null||n===void 0?void 0:n.querySelector('[data-testid="user-message"]');if(l){let c=l.textContent||"";return c.length>50?c.slice(0,50)+"...":c}return"Claude Conversation"}}g.ClaudeExtractor=p},458:(I,g,m)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.HackerNewsExtractor=void 0;let f=m(279);class p extends f.BaseExtractor{constructor(t,o){super(t,o),this.mainPost=t.querySelector(".fatitem"),this.isCommentPage=this.detectCommentPage(),this.mainComment=this.isCommentPage?this.findMainComment():null}detectCommentPage(){var t;return!!(!((t=this.mainPost)===null||t===void 0)&&t.querySelector('.navs a[href*="parent"]'))}findMainComment(){var t;return((t=this.mainPost)===null||t===void 0?void 0:t.querySelector(".comment"))||null}canExtract(){return!!this.mainPost}extract(){let t=this.getPostContent(),o=this.extractComments(),r=this.createContentHtml(t,o),e=this.getPostTitle(),n=this.getPostAuthor(),i=this.createDescription(),a=this.getPostDate();return{content:r,contentHtml:r,extractedContent:{postId:this.getPostId(),postAuthor:n},variables:{title:e,author:n,site:"Hacker News",description:i,published:a}}}createContentHtml(t,o){return`
			<div class="hackernews-post">
				<div class="post-content">
					${t}
				</div>
				${o?`
					<hr>
					<h2>Comments</h2>
					<div class="hackernews-comments">
						${o}
					</div>
				`:""}
			</div>
		`.trim()}getPostContent(){var t,o,r,e,n,i;if(!this.mainPost)return"";if(this.isCommentPage&&this.mainComment){let v=((t=this.mainComment.querySelector(".hnuser"))===null||t===void 0?void 0:t.textContent)||"[deleted]",d=((o=this.mainComment.querySelector(".commtext"))===null||o===void 0?void 0:o.innerHTML)||"",b=this.mainComment.querySelector(".age"),h=(b?.getAttribute("title")||"").split("T")[0]||"",C=((e=(r=this.mainComment.querySelector(".score"))===null||r===void 0?void 0:r.textContent)===null||e===void 0?void 0:e.trim())||"",E=((n=this.mainPost.querySelector('.navs a[href*="parent"]'))===null||n===void 0?void 0:n.getAttribute("href"))||"";return`
				<div class="comment main-comment">
					<div class="comment-metadata">
						<span class="comment-author"><strong>${v}</strong></span> \u2022
						<span class="comment-date">${h}</span>
						${C?` \u2022 <span class="comment-points">${C}</span>`:""}
						${E?` \u2022 <a href="https://news.ycombinator.com/${E}" class="parent-link">parent</a>`:""}
					</div>
					<div class="comment-content">${d}</div>
				</div>
			`.trim()}let a=this.mainPost.querySelector("tr.athing"),l=(a?.nextElementSibling,((i=a?.querySelector(".titleline a"))===null||i===void 0?void 0:i.getAttribute("href"))||""),c="";l&&(c+=`<p><a href="${l}" target="_blank">${l}</a></p>`);let u=this.mainPost.querySelector(".toptext");return u&&(c+=`<div class="post-text">${u.innerHTML}</div>`),c}extractComments(){let t=Array.from(this.document.querySelectorAll("tr.comtr"));return this.processComments(t)}processComments(t){var o,r,e,n;let i="",a=new Set,l=-1,c=[];for(let u of t){let v=u.getAttribute("id");if(!v||a.has(v))continue;a.add(v);let d=((o=u.querySelector(".ind img"))===null||o===void 0?void 0:o.getAttribute("width"))||"0",b=parseInt(d)/40,h=u.querySelector(".commtext"),C=((r=u.querySelector(".hnuser"))===null||r===void 0?void 0:r.textContent)||"[deleted]",E=u.querySelector(".age"),S=((n=(e=u.querySelector(".score"))===null||e===void 0?void 0:e.textContent)===null||n===void 0?void 0:n.trim())||"";if(!h)continue;let k=`https://news.ycombinator.com/item?id=${v}`,M=(E?.getAttribute("title")||"").split("T")[0]||"";if(b===0){for(;c.length>0;)i+="</blockquote>",c.pop();i+="<blockquote>",c=[0],l=0}else if(b<l)for(;c.length>0&&c[c.length-1]>=b;)i+="</blockquote>",c.pop();else b>l&&(i+="<blockquote>",c.push(b));i+=`<div class="comment">
	<div class="comment-metadata">
		<span class="comment-author"><strong>${C}</strong></span> \u2022
		<a href="${k}" class="comment-link">${M}</a>
		${S?` \u2022 <span class="comment-points">${S}</span>`:""}
	</div>
	<div class="comment-content">${h.innerHTML}</div>
</div>`,l=b}for(;c.length>0;)i+="</blockquote>",c.pop();return i}getPostId(){let t=this.url.match(/id=(\d+)/);return t?.[1]||""}getPostTitle(){var t,o,r,e,n;if(this.isCommentPage&&this.mainComment){let i=((t=this.mainComment.querySelector(".hnuser"))===null||t===void 0?void 0:t.textContent)||"[deleted]",a=((o=this.mainComment.querySelector(".commtext"))===null||o===void 0?void 0:o.textContent)||"";return`Comment by ${i}: ${a.trim().slice(0,50)+(a.length>50?"...":"")}`}return((n=(e=(r=this.mainPost)===null||r===void 0?void 0:r.querySelector(".titleline"))===null||e===void 0?void 0:e.textContent)===null||n===void 0?void 0:n.trim())||""}getPostAuthor(){var t,o,r;return((r=(o=(t=this.mainPost)===null||t===void 0?void 0:t.querySelector(".hnuser"))===null||o===void 0?void 0:o.textContent)===null||r===void 0?void 0:r.trim())||""}createDescription(){let t=this.getPostTitle(),o=this.getPostAuthor();return this.isCommentPage?`Comment by ${o} on Hacker News`:`${t} - by ${o} on Hacker News`}getPostDate(){if(!this.mainPost)return"";let t=this.mainPost.querySelector(".age");return(t?.getAttribute("title")||"").split("T")[0]||""}}g.HackerNewsExtractor=p},552:(I,g)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.isElement=function(p){return p.nodeType===m.ELEMENT_NODE},g.isTextNode=function(p){return p.nodeType===m.TEXT_NODE},g.isCommentNode=function(p){return p.nodeType===m.COMMENT_NODE},g.getComputedStyle=function(p){let w=f(p.ownerDocument);return w?w.getComputedStyle(p):null},g.getWindow=f,g.logDebug=function(p,...w){typeof window<"u"&&window.defuddleDebug&&console.log("Defuddle:",p,...w)};let m={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12};function f(p){return p.defaultView?p.defaultView:p.ownerWindow?p.ownerWindow:p.window?p.window:null}},588:(I,g,m)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.GitHubExtractor=void 0;let f=m(279);class p extends f.BaseExtractor{canExtract(){return['meta[name="expected-hostname"][content="github.com"]','meta[name="octolytics-url"]','meta[name="github-keyboard-shortcuts"]',".js-header-wrapper","#js-repo-pjax-container"].some((t=>this.document.querySelector(t)!==null))&&Object.values({issue:['[data-testid="issue-metadata-sticky"]','[data-testid="issue-title"]']}).some((t=>t.some((o=>this.document.querySelector(o)!==null))))}extract(){return this.extractIssue()}extractIssue(){let t=this.extractRepoInfo(),o=this.extractIssueNumber(),r="",e=this.document.querySelector('[data-testid="issue-viewer-issue-container"]');if(e){let a=this.extractAuthor(e,['a[data-testid="issue-body-header-author"]',".IssueBodyHeaderAuthor-module__authorLoginLink--_S7aT",".ActivityHeader-module__AuthorLink--iofTU",'a[href*="/users/"][data-hovercard-url*="/users/"]','a[aria-label*="profile"]']),l=e.querySelector("relative-time"),c=l?.getAttribute("datetime")||"",u=e.querySelector('[data-testid="issue-body-viewer"] .markdown-body');if(u){let v=this.cleanBodyContent(u);if(r+=`<div class="issue-author"><strong>${a}</strong>`,c){let d=new Date(c);r+=` opened this issue on ${d.toLocaleDateString()}`}r+=`</div>

`,r+=`<div class="issue-body">${v}</div>

`}}let n=Array.from(this.document.querySelectorAll("[data-wrapper-timeline-id]")),i=new Set;return n.forEach((a=>{let l=a.querySelector(".react-issue-comment");if(!l)return;let c=a.getAttribute("data-wrapper-timeline-id");if(!c||i.has(c))return;i.add(c);let u=this.extractAuthor(l,[".ActivityHeader-module__AuthorLink--iofTU",'a[data-testid="avatar-link"]','a[href^="/"][data-hovercard-url*="/users/"]']),v=l.querySelector("relative-time"),d=v?.getAttribute("datetime")||"",b=l.querySelector(".markdown-body");if(b){let h=this.cleanBodyContent(b);if(h){if(r+=`<div class="comment">
`,r+=`<div class="comment-header"><strong>${u}</strong>`,d){let C=new Date(d);r+=` commented on ${C.toLocaleDateString()}`}r+=`</div>
`,r+=`<div class="comment-body">${h}</div>
`,r+=`</div>

`}}})),{content:r,contentHtml:r,extractedContent:{type:"issue",issueNumber:o,repository:t.repo,owner:t.owner},variables:{title:this.document.title,author:"",site:`GitHub - ${t.owner}/${t.repo}`,description:this.createDescription(r)}}}extractAuthor(t,o){for(let r of o){let e=t.querySelector(r);if(e){let n=e.getAttribute("href");if(n){if(n.startsWith("/"))return n.substring(1);if(n.includes("github.com/")){let i=n.match(/github\.com\/([^\/\?#]+)/);if(i&&i[1])return i[1]}}}}return"Unknown"}cleanBodyContent(t){let o=t.cloneNode(!0);return o.querySelectorAll('button, [data-testid*="button"], [data-testid*="menu"]').forEach((r=>r.remove())),o.querySelectorAll(".js-clipboard-copy, .zeroclipboard-container").forEach((r=>r.remove())),o.innerHTML.trim()}extractIssueNumber(){var t;let o=this.url.match(/\/(issues|pull)\/(\d+)/);if(o)return o[2];let r=this.document.querySelector("h1"),e=(t=r?.textContent)===null||t===void 0?void 0:t.match(/#(\d+)/);return e?e[1]:""}extractRepoInfo(){let t=this.url.match(/github\.com\/([^\/]+)\/([^\/]+)/);if(t)return{owner:t[1],repo:t[2]};let o=this.document.title.match(/([^\/\s]+)\/([^\/\s]+)/);return o?{owner:o[1],repo:o[2]}:{owner:"",repo:""}}createDescription(t){var o;if(!t)return"";let r=this.document.createElement("div");return r.innerHTML=t,((o=r.textContent)===null||o===void 0?void 0:o.trim().slice(0,140).replace(/\s+/g," "))||""}}g.GitHubExtractor=p},608:(I,g)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.MetadataExtractor=void 0,g.MetadataExtractor=class{static extract(m,f,p){var w,t;let o="",r="";try{if(r=((w=m.location)===null||w===void 0?void 0:w.href)||"",r||(r=this.getMetaContent(p,"property","og:url")||this.getMetaContent(p,"property","twitter:url")||this.getSchemaProperty(f,"url")||this.getSchemaProperty(f,"mainEntityOfPage.url")||this.getSchemaProperty(f,"mainEntity.url")||this.getSchemaProperty(f,"WebSite.url")||((t=m.querySelector('link[rel="canonical"]'))===null||t===void 0?void 0:t.getAttribute("href"))||""),r)try{o=new URL(r).hostname.replace(/^www\./,"")}catch(e){console.warn("Failed to parse URL:",e)}}catch{let n=m.querySelector("base[href]");if(n)try{r=n.getAttribute("href")||"",o=new URL(r).hostname.replace(/^www\./,"")}catch(i){console.warn("Failed to parse base URL:",i)}}return{title:this.getTitle(m,f,p),description:this.getDescription(m,f,p),domain:o,favicon:this.getFavicon(m,r,p),image:this.getImage(m,f,p),published:this.getPublished(m,f,p),author:this.getAuthor(m,f,p),site:this.getSite(m,f,p),schemaOrgData:f,wordCount:0,parseTime:0}}static getAuthor(m,f,p){let w;if(w=this.getMetaContent(p,"name","sailthru.author")||this.getMetaContent(p,"property","author")||this.getMetaContent(p,"name","author")||this.getMetaContent(p,"name","byl")||this.getMetaContent(p,"name","authorList"),w)return w;let t=this.getSchemaProperty(f,"author.name")||this.getSchemaProperty(f,"author.[].name");if(t){let r=t.split(",").map((e=>e.trim().replace(/,$/,"").trim())).filter(Boolean);if(r.length>0){let e=[...new Set(r)];return e.length>10&&(e=e.slice(0,10)),e.join(", ")}}let o=[];if(['[itemprop="author"]',".author",'[href*="author"]',".authors a"].forEach((r=>{m.querySelectorAll(r).forEach((e=>{var n;(n=e.textContent)&&n.split(",").forEach((i=>{let a=i.trim().replace(/,$/,"").trim(),l=a.toLowerCase();a&&l!=="author"&&l!=="authors"&&o.push(a)}))}))})),o.length>0){let r=[...new Set(o.map((e=>e.trim())).filter(Boolean))];if(r.length>0)return r.length>10&&(r=r.slice(0,10)),r.join(", ")}return w=this.getMetaContent(p,"name","copyright")||this.getSchemaProperty(f,"copyrightHolder.name")||this.getMetaContent(p,"property","og:site_name")||this.getSchemaProperty(f,"publisher.name")||this.getSchemaProperty(f,"sourceOrganization.name")||this.getSchemaProperty(f,"isPartOf.name")||this.getMetaContent(p,"name","twitter:creator")||this.getMetaContent(p,"name","application-name"),w||""}static getSite(m,f,p){return this.getSchemaProperty(f,"publisher.name")||this.getMetaContent(p,"property","og:site_name")||this.getSchemaProperty(f,"WebSite.name")||this.getSchemaProperty(f,"sourceOrganization.name")||this.getMetaContent(p,"name","copyright")||this.getSchemaProperty(f,"copyrightHolder.name")||this.getSchemaProperty(f,"isPartOf.name")||this.getMetaContent(p,"name","application-name")||this.getAuthor(m,f,p)||""}static getTitle(m,f,p){var w,t;let o=this.getMetaContent(p,"property","og:title")||this.getMetaContent(p,"name","twitter:title")||this.getSchemaProperty(f,"headline")||this.getMetaContent(p,"name","title")||this.getMetaContent(p,"name","sailthru.title")||((t=(w=m.querySelector("title"))===null||w===void 0?void 0:w.textContent)===null||t===void 0?void 0:t.trim())||"";return this.cleanTitle(o,this.getSite(m,f,p))}static cleanTitle(m,f){if(!m||!f)return m;let p=f.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),w=[`\\s*[\\|\\-\u2013\u2014]\\s*${p}\\s*$`,`^\\s*${p}\\s*[\\|\\-\u2013\u2014]\\s*`];for(let t of w){let o=new RegExp(t,"i");if(o.test(m)){m=m.replace(o,"");break}}return m.trim()}static getDescription(m,f,p){return this.getMetaContent(p,"name","description")||this.getMetaContent(p,"property","description")||this.getMetaContent(p,"property","og:description")||this.getSchemaProperty(f,"description")||this.getMetaContent(p,"name","twitter:description")||this.getMetaContent(p,"name","sailthru.description")||""}static getImage(m,f,p){return this.getMetaContent(p,"property","og:image")||this.getMetaContent(p,"name","twitter:image")||this.getSchemaProperty(f,"image.url")||this.getMetaContent(p,"name","sailthru.image.full")||""}static getFavicon(m,f,p){var w,t;let o=this.getMetaContent(p,"property","og:image:favicon");if(o)return o;let r=(w=m.querySelector("link[rel='icon']"))===null||w===void 0?void 0:w.getAttribute("href");if(r)return r;let e=(t=m.querySelector("link[rel='shortcut icon']"))===null||t===void 0?void 0:t.getAttribute("href");if(e)return e;if(f)try{return new URL("/favicon.ico",f).href}catch(n){console.warn("Failed to construct favicon URL:",n)}return""}static getPublished(m,f,p){var w,t;return this.getSchemaProperty(f,"datePublished")||this.getMetaContent(p,"name","publishDate")||this.getMetaContent(p,"property","article:published_time")||((t=(w=m.querySelector('abbr[itemprop="datePublished"]'))===null||w===void 0?void 0:w.title)===null||t===void 0?void 0:t.trim())||this.getTimeElement(m)||this.getMetaContent(p,"name","sailthru.date")||""}static getMetaContent(m,f,p){var w,t;let o=m.find((r=>{let e=f==="name"?r.name:r.property;return e?.toLowerCase()===p.toLowerCase()}));return o&&(t=(w=o.content)===null||w===void 0?void 0:w.trim())!==null&&t!==void 0?t:""}static getTimeElement(m){var f,p,w,t;let o=Array.from(m.querySelectorAll("time"))[0];return o&&(t=(p=(f=o.getAttribute("datetime"))===null||f===void 0?void 0:f.trim())!==null&&p!==void 0?p:(w=o.textContent)===null||w===void 0?void 0:w.trim())!==null&&t!==void 0?t:""}static getSchemaProperty(m,f,p=""){if(!m)return p;let w=(t,o,r,e=!0)=>{if(typeof t=="string")return o.length===0?[t]:[];if(!t||typeof t!="object")return[];if(Array.isArray(t)){let a=o[0];if(/^\\[\\d+\\]$/.test(a)){let l=parseInt(a.slice(1,-1));return t[l]?w(t[l],o.slice(1),r,e):[]}return o.length===0&&t.every((l=>typeof l=="string"||typeof l=="number"))?t.map(String):t.flatMap((l=>w(l,o,r,e)))}let[n,...i]=o;if(!n)return typeof t=="string"?[t]:typeof t=="object"&&t.name?[t.name]:[];if(t.hasOwnProperty(n))return w(t[n],i,r?`${r}.${n}`:n,!0);if(!e){let a=[];for(let l in t)if(typeof t[l]=="object"){let c=w(t[l],o,r?`${r}.${l}`:l,!1);a.push(...c)}if(a.length>0)return a}return[]};try{let t=w(m,f.split("."),"",!0);return t.length===0&&(t=w(m,f.split("."),"",!1)),t.length>0?t.filter(Boolean).join(", "):p}catch(t){return console.error(`Error in getSchemaProperty for ${f}:`,t),p}}}},610:(I,g,m)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.standardizeFootnotes=function(w){let t=w.ownerDocument;if(!t)return void console.warn("standardizeFootnotes: No document available");new p(t).standardizeFootnotes(w)};let f=m(640);class p{constructor(t){this.doc=t}createFootnoteItem(t,o,r){let e=typeof o=="string"?this.doc:o.ownerDocument,n=e.createElement("li");if(n.className="footnote",n.id=`fn:${t}`,typeof o=="string"){let a=e.createElement("p");a.innerHTML=o,n.appendChild(a)}else{let a=Array.from(o.querySelectorAll("p"));if(a.length===0){let l=e.createElement("p");l.innerHTML=o.innerHTML,n.appendChild(l)}else a.forEach((l=>{let c=e.createElement("p");c.innerHTML=l.innerHTML,n.appendChild(c)}))}let i=n.querySelector("p:last-of-type")||n;return r.forEach(((a,l)=>{let c=e.createElement("a");c.href=`#${a}`,c.title="return to article",c.className="footnote-backref",c.innerHTML="\u21A9",l<r.length-1&&(c.innerHTML+=" "),i.appendChild(c)})),n}collectFootnotes(t){let o={},r=1,e=new Set;return t.querySelectorAll(f.FOOTNOTE_LIST_SELECTORS).forEach((n=>{if(n.matches('div.footnote[data-component-name="FootnoteToDOM"]')){let i=n.querySelector("a.footnote-number"),a=n.querySelector(".footnote-content");if(i&&a){let l=i.id.replace("footnote-","").toLowerCase();l&&!e.has(l)&&(o[r]={content:a,originalId:l,refs:[]},e.add(l),r++)}return}n.querySelectorAll('li, div[role="listitem"]').forEach((i=>{var a,l,c,u;let v="",d=null,b=i.querySelector(".citations");if(!((a=b?.id)===null||a===void 0)&&a.toLowerCase().startsWith("r")){v=b.id.toLowerCase();let h=b.querySelector(".citation-content");h&&(d=h)}else{if(i.id.toLowerCase().startsWith("bib.bib"))v=i.id.replace("bib.bib","").toLowerCase();else if(i.id.toLowerCase().startsWith("fn:"))v=i.id.replace("fn:","").toLowerCase();else if(i.id.toLowerCase().startsWith("fn"))v=i.id.replace("fn","").toLowerCase();else if(i.hasAttribute("data-counter"))v=((c=(l=i.getAttribute("data-counter"))===null||l===void 0?void 0:l.replace(/\.$/,""))===null||c===void 0?void 0:c.toLowerCase())||"";else{let h=(u=i.id.split("/").pop())===null||u===void 0?void 0:u.match(/cite_note-(.+)/);v=h?h[1].toLowerCase():i.id.toLowerCase()}d=i}v&&!e.has(v)&&(o[r]={content:d||i,originalId:v,refs:[]},e.add(v),r++)}))})),o}findOuterFootnoteContainer(t){let o=t,r=t.parentElement;for(;r&&(r.tagName.toLowerCase()==="span"||r.tagName.toLowerCase()==="sup");)o=r,r=r.parentElement;return o}createFootnoteReference(t,o){let r=this.doc.createElement("sup");r.id=o;let e=this.doc.createElement("a");return e.href=`#fn:${t}`,e.textContent=t,r.appendChild(e),r}standardizeFootnotes(t){let o=this.collectFootnotes(t),r=t.querySelectorAll(f.FOOTNOTE_INLINE_REFERENCES),e=new Map;r.forEach((a=>{var l,c,u,v;if(!a)return;let d="",b="";if(a.matches('a[id^="ref-link"]'))d=((l=a.textContent)===null||l===void 0?void 0:l.trim())||"";else if(a.matches('a[role="doc-biblioref"]')){let h=a.getAttribute("data-xml-rid");if(h)d=h;else{let C=a.getAttribute("href");C?.startsWith("#core-R")&&(d=C.replace("#core-",""))}}else if(a.matches("a.footnote-anchor, span.footnote-hovercard-target a")){let h=((c=a.id)===null||c===void 0?void 0:c.replace("footnote-anchor-",""))||"";h&&(d=h.toLowerCase())}else if(a.matches("cite.ltx_cite")){let h=a.querySelector("a");if(h){let C=h.getAttribute("href");if(C){let E=(u=C.split("/").pop())===null||u===void 0?void 0:u.match(/bib\.bib(\d+)/);E&&(d=E[1].toLowerCase())}}}else if(a.matches("sup.reference")){let h=a.querySelectorAll("a");Array.from(h).forEach((C=>{var E;let S=C.getAttribute("href");if(S){let k=(E=S.split("/").pop())===null||E===void 0?void 0:E.match(/(?:cite_note|cite_ref)-(.+)/);k&&(d=k[1].toLowerCase())}}))}else if(a.matches('sup[id^="fnref:"]'))d=a.id.replace("fnref:","").toLowerCase();else if(a.matches('sup[id^="fnr"]'))d=a.id.replace("fnr","").toLowerCase();else if(a.matches("span.footnote-reference"))d=a.getAttribute("data-footnote-id")||"";else if(a.matches("span.footnote-link"))d=a.getAttribute("data-footnote-id")||"",b=a.getAttribute("data-footnote-content")||"";else if(a.matches("a.citation"))d=((v=a.textContent)===null||v===void 0?void 0:v.trim())||"",b=a.getAttribute("href")||"";else if(a.matches('a[id^="fnref"]'))d=a.id.replace("fnref","").toLowerCase();else{let h=a.getAttribute("href");h&&(d=h.replace(/^[#]/,"").toLowerCase())}if(d){let h=Object.entries(o).find((([C,E])=>E.originalId===d.toLowerCase()));if(h){let[C,E]=h,S=E.refs.length>0?`fnref:${C}-${E.refs.length+1}`:`fnref:${C}`;E.refs.push(S);let k=this.findOuterFootnoteContainer(a);k.tagName.toLowerCase()==="sup"?(e.has(k)||e.set(k,[]),e.get(k).push(this.createFootnoteReference(C,S))):k.replaceWith(this.createFootnoteReference(C,S))}}})),e.forEach(((a,l)=>{if(a.length>0){let c=this.doc.createDocumentFragment();a.forEach((u=>{let v=u.querySelector("a");if(v){let d=this.doc.createElement("sup");d.id=u.id,d.appendChild(v.cloneNode(!0)),c.appendChild(d)}})),l.replaceWith(c)}}));let n=this.doc.createElement("div");n.id="footnotes";let i=this.doc.createElement("ol");Object.entries(o).forEach((([a,l])=>{let c=this.createFootnoteItem(parseInt(a),l.content,l.refs);i.appendChild(c)})),t.querySelectorAll(f.FOOTNOTE_LIST_SELECTORS).forEach((a=>a.remove())),i.children.length>0&&(n.appendChild(i),t.appendChild(n))}}},628:(I,g,m)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.Defuddle=void 0;let f=m(608),p=m(917),w=m(640),t=m(840),o=m(968),r=m(552);g.Defuddle=class{constructor(e,n={}){this.doc=e,this.options=n,this.debug=n.debug||!1}parse(){let e=this.parseInternal();if(e.wordCount<200){console.log("Initial parse returned very little content, trying again");let n=this.parseInternal({removePartialSelectors:!1});if(n.wordCount>e.wordCount)return this._log("Retry produced more content"),n}return e}parseInternal(e={}){var n,i,a;let l=Date.now(),c=Object.assign(Object.assign({removeExactSelectors:!0,removePartialSelectors:!0},this.options),e),u=this._extractSchemaOrgData(this.doc),v=[];this.doc.querySelectorAll("meta").forEach((b=>{let h=b.getAttribute("name"),C=b.getAttribute("property"),E=b.getAttribute("content");E&&v.push({name:h,property:C,content:this._decodeHTMLEntities(E)})}));let d=f.MetadataExtractor.extract(this.doc,u,v);c.removeImages&&this.removeImages(this.doc);try{let b=c.url||this.doc.URL,h=p.ExtractorRegistry.findExtractor(this.doc,b,u);if(h&&h.canExtract()){let q=h.extract(),j=Date.now();return{content:q.contentHtml,title:((n=q.variables)===null||n===void 0?void 0:n.title)||d.title,description:d.description,domain:d.domain,favicon:d.favicon,image:d.image,published:((i=q.variables)===null||i===void 0?void 0:i.published)||d.published,author:((a=q.variables)===null||a===void 0?void 0:a.author)||d.author,site:d.site,schemaOrgData:d.schemaOrgData,wordCount:this.countWords(q.contentHtml),parseTime:Math.round(j-l),extractorType:h.constructor.name.replace("Extractor","").toLowerCase(),metaTags:v}}let C=this._evaluateMediaQueries(this.doc),E=this.findSmallImages(this.doc),S=this.doc.cloneNode(!0);this.applyMobileStyles(S,C);let k=this.findMainContent(S);if(!k){let q=Date.now();return Object.assign(Object.assign({content:this.doc.body.innerHTML},d),{wordCount:this.countWords(this.doc.body.innerHTML),parseTime:Math.round(q-l),metaTags:v})}this.removeSmallImages(S,E),this.removeHiddenElements(S),o.ContentScorer.scoreAndRemove(S,this.debug),(c.removeExactSelectors||c.removePartialSelectors)&&this.removeBySelector(S,c.removeExactSelectors,c.removePartialSelectors),(0,t.standardizeContent)(k,d,this.doc,this.debug);let M=k.outerHTML,$=Date.now();return Object.assign(Object.assign({content:M},d),{wordCount:this.countWords(M),parseTime:Math.round($-l),metaTags:v})}catch(b){console.error("Defuddle","Error processing document:",b);let h=Date.now();return Object.assign(Object.assign({content:this.doc.body.innerHTML},d),{wordCount:this.countWords(this.doc.body.innerHTML),parseTime:Math.round(h-l),metaTags:v})}}countWords(e){let n=this.doc.createElement("div");return n.innerHTML=e,(n.textContent||"").trim().replace(/\s+/g," ").split(" ").filter((i=>i.length>0)).length}_log(...e){this.debug&&console.log("Defuddle:",...e)}_evaluateMediaQueries(e){let n=[],i=/max-width[^:]*:\s*(\d+)/;try{Array.from(e.styleSheets).filter((l=>{try{return l.cssRules,!0}catch(c){return c instanceof DOMException&&c.name,!1}})).flatMap((l=>{try{return typeof CSSMediaRule>"u"?[]:Array.from(l.cssRules).filter((c=>c instanceof CSSMediaRule&&c.conditionText.includes("max-width")))}catch(c){return this.debug&&console.warn("Defuddle: Failed to process stylesheet:",c),[]}})).forEach((l=>{let c=l.conditionText.match(i);if(c){let u=parseInt(c[1]);w.MOBILE_WIDTH<=u&&Array.from(l.cssRules).filter((v=>v instanceof CSSStyleRule)).forEach((v=>{try{n.push({selector:v.selectorText,styles:v.style.cssText})}catch(d){this.debug&&console.warn("Defuddle: Failed to process CSS rule:",d)}}))}}))}catch(a){console.error("Defuddle: Error evaluating media queries:",a)}return n}applyMobileStyles(e,n){n.forEach((({selector:i,styles:a})=>{try{e.querySelectorAll(i).forEach((l=>{l.setAttribute("style",(l.getAttribute("style")||"")+a)}))}catch(l){console.error("Defuddle","Error applying styles for selector:",i,l)}}))}removeImages(e){let n=e.getElementsByTagName("img");Array.from(n).forEach((i=>{i.remove()}))}removeHiddenElements(e){let n=0,i=new Set,a=Array.from(e.getElementsByTagName("*"));for(let l=0;l<a.length;l+=100){let c=a.slice(l,l+100),u=c.map((v=>{var d,b;try{return(d=v.ownerDocument.defaultView)===null||d===void 0?void 0:d.getComputedStyle(v)}catch{let C=v.getAttribute("style");if(!C)return null;let E=e.createElement("style");E.textContent=`* { ${C} }`,e.head.appendChild(E);let S=(b=v.ownerDocument.defaultView)===null||b===void 0?void 0:b.getComputedStyle(v);return e.head.removeChild(E),S}}));c.forEach(((v,d)=>{let b=u[d];!b||b.display!=="none"&&b.visibility!=="hidden"&&b.opacity!=="0"||(i.add(v),n++)}))}this._log("Removed hidden elements:",n)}removeBySelector(e,n=!0,i=!0){let a=Date.now(),l=0,c=0,u=new Set;if(n&&e.querySelectorAll(w.EXACT_SELECTORS.join(",")).forEach((d=>{d?.parentNode&&(u.add(d),l++)})),i){let d=w.PARTIAL_SELECTORS.join("|"),b=new RegExp(d,"i"),h=w.TEST_ATTRIBUTES.map((C=>`[${C}]`)).join(",");e.querySelectorAll(h).forEach((C=>{if(u.has(C))return;let E=w.TEST_ATTRIBUTES.map((S=>S==="class"?C.className&&typeof C.className=="string"?C.className:"":S==="id"?C.id||"":C.getAttribute(S)||"")).join(" ").toLowerCase();E.trim()&&b.test(E)&&(u.add(C),c++)}))}u.forEach((d=>d.remove()));let v=Date.now();this._log("Removed clutter elements:",{exactSelectors:l,partialSelectors:c,total:u.size,processingTime:`${(v-a).toFixed(2)}ms`})}findSmallImages(e){let n=new Set,i=/scale\(([\d.]+)\)/,a=Date.now(),l=0,c=[...Array.from(e.getElementsByTagName("img")),...Array.from(e.getElementsByTagName("svg"))];if(c.length===0)return n;let u=c.map((d=>({element:d,naturalWidth:d.tagName.toLowerCase()==="img"&&parseInt(d.getAttribute("width")||"0")||0,naturalHeight:d.tagName.toLowerCase()==="img"&&parseInt(d.getAttribute("height")||"0")||0,attrWidth:parseInt(d.getAttribute("width")||"0"),attrHeight:parseInt(d.getAttribute("height")||"0")})));for(let d=0;d<u.length;d+=50){let b=u.slice(d,d+50);try{let h=b.map((({element:E})=>{var S;try{return(S=E.ownerDocument.defaultView)===null||S===void 0?void 0:S.getComputedStyle(E)}catch{return null}})),C=b.map((({element:E})=>{try{return E.getBoundingClientRect()}catch{return null}}));b.forEach(((E,S)=>{var k;try{let M=h[S],$=C[S];if(!M)return;let q=M.transform,j=q?parseFloat(((k=q.match(i))===null||k===void 0?void 0:k[1])||"1"):1,s=[E.naturalWidth,E.attrWidth,parseInt(M.width)||0,$?$.width*j:0].filter((y=>typeof y=="number"&&y>0)),x=[E.naturalHeight,E.attrHeight,parseInt(M.height)||0,$?$.height*j:0].filter((y=>typeof y=="number"&&y>0));if(s.length>0&&x.length>0){let y=Math.min(...s),T=Math.min(...x);if(y<33||T<33){let L=this.getElementIdentifier(E.element);L&&(n.add(L),l++)}}}catch(M){this.debug&&console.warn("Defuddle: Failed to process element dimensions:",M)}}))}catch(h){this.debug&&console.warn("Defuddle: Failed to process batch:",h)}}let v=Date.now();return this._log("Found small elements:",{count:l,processingTime:`${(v-a).toFixed(2)}ms`}),n}removeSmallImages(e,n){let i=0;["img","svg"].forEach((a=>{let l=e.getElementsByTagName(a);Array.from(l).forEach((c=>{let u=this.getElementIdentifier(c);u&&n.has(u)&&(c.remove(),i++)}))})),this._log("Removed small elements:",i)}getElementIdentifier(e){if(e.tagName.toLowerCase()==="img"){let l=e.getAttribute("data-src");if(l)return`src:${l}`;let c=e.getAttribute("src")||"",u=e.getAttribute("srcset")||"",v=e.getAttribute("data-srcset");if(c)return`src:${c}`;if(u)return`srcset:${u}`;if(v)return`srcset:${v}`}let n=e.id||"",i=e.className||"",a=e.tagName.toLowerCase()==="svg"&&e.getAttribute("viewBox")||"";return n?`id:${n}`:a?`viewBox:${a}`:i?`class:${i}`:null}findMainContent(e){let n=[];if(w.ENTRY_POINT_ELEMENTS.forEach(((i,a)=>{e.querySelectorAll(i).forEach((l=>{let c=40*(w.ENTRY_POINT_ELEMENTS.length-a);c+=o.ContentScorer.scoreElement(l),n.push({element:l,score:c})}))})),n.length===0)return this.findContentByScoring(e);if(n.sort(((i,a)=>a.score-i.score)),this.debug&&this._log("Content candidates:",n.map((i=>({element:i.element.tagName,selector:this.getElementSelector(i.element),score:i.score})))),n.length===1&&n[0].element.tagName.toLowerCase()==="body"){let i=this.findTableBasedContent(e);if(i)return i}return n[0].element}findTableBasedContent(e){if(!Array.from(e.getElementsByTagName("table")).some((i=>{let a=parseInt(i.getAttribute("width")||"0"),l=this.getComputedStyle(i);return a>400||l?.width.includes("px")&&parseInt(l.width)>400||i.getAttribute("align")==="center"||i.className.toLowerCase().includes("content")||i.className.toLowerCase().includes("article")})))return null;let n=Array.from(e.getElementsByTagName("td"));return o.ContentScorer.findBestElement(n)}findContentByScoring(e){let n=[];return w.BLOCK_ELEMENTS.forEach((i=>{Array.from(e.getElementsByTagName(i)).forEach((a=>{let l=o.ContentScorer.scoreElement(a);l>0&&n.push({score:l,element:a})}))})),n.length>0?n.sort(((i,a)=>a.score-i.score))[0].element:null}getElementSelector(e){let n=[],i=e;for(;i&&i!==this.doc.documentElement;){let a=i.tagName.toLowerCase();i.id?a+="#"+i.id:i.className&&typeof i.className=="string"&&(a+="."+i.className.trim().split(/\s+/).join(".")),n.unshift(a),i=i.parentElement}return n.join(" > ")}getComputedStyle(e){return(0,r.getComputedStyle)(e)}_extractSchemaOrgData(e){let n=e.querySelectorAll('script[type="application/ld+json"]'),i=[];n.forEach((l=>{let c=l.textContent||"";try{c=c.replace(/\/\*[\s\S]*?\*\/|^\s*\/\/.*$/gm,"").replace(/^\s*<!\[CDATA\[([\s\S]*?)\]\]>\s*$/,"$1").replace(/^\s*(\*\/|\/\*)\s*|\s*(\*\/|\/\*)\s*$/g,"").trim();let u=JSON.parse(c);u["@graph"]&&Array.isArray(u["@graph"])?i.push(...u["@graph"]):i.push(u)}catch(u){console.error("Defuddle: Error parsing schema.org data:",u),this.debug&&console.error("Defuddle: Problematic JSON content:",c)}}));let a=l=>{if(typeof l=="string")return this._decodeHTMLEntities(l);if(Array.isArray(l))return l.map(a);if(typeof l=="object"&&l!==null){let c={};for(let u in l)Object.prototype.hasOwnProperty.call(l,u)&&(c[u]=a(l[u]));return c}return l};return i.map(a)}_decodeHTMLEntities(e){let n=this.doc.createElement("textarea");return n.innerHTML=e,n.value}}},632:(I,g,m)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.ChatGPTExtractor=void 0;let f=m(181);class p extends f.ConversationExtractor{constructor(t,o){super(t,o),this.articles=t.querySelectorAll('article[data-testid^="conversation-turn-"]'),this.footnotes=[],this.footnoteCounter=0}canExtract(){return!!this.articles&&this.articles.length>0}extractMessages(){let t=[];return this.footnotes=[],this.footnoteCounter=0,this.articles&&this.articles.forEach((o=>{var r,e;let n=o.querySelector("h5.sr-only, h6.sr-only"),i=((e=(r=n?.textContent)===null||r===void 0?void 0:r.trim())===null||e===void 0?void 0:e.replace(/:\s*$/,""))||"",a="",l=o.getAttribute("data-message-author-role");l&&(a=l);let c=o.innerHTML||"";c=c.replace(/\u200B/g,"");let u=document.createElement("div");u.innerHTML=c,u.querySelectorAll('h5.sr-only, h6.sr-only, span[data-state="closed"]').forEach((v=>v.remove())),c=u.innerHTML,c=c.replace(/(&ZeroWidthSpace;)?(<span[^>]*?>\s*<a(?=[^>]*?href="([^"]+)")(?=[^>]*?target="_blank")(?=[^>]*?rel="noopener")[^>]*?>[\s\S]*?<\/a>\s*<\/span>)/gi,((v,d,b,h)=>{let C="",E="";try{C=new URL(h).hostname.replace(/^www\./,"");let M=h.split("#:~:text=");if(M.length>1){E=decodeURIComponent(M[1]),E=E.replace(/%2C/g,",");let $=E.split(",");E=$.length>1&&$[0].trim()?` \u2014 ${$[0].trim()}...`:$[0].trim()?` \u2014 ${E.trim()}`:""}}catch(M){console.error(`Failed to parse URL: ${h}`,M),C=h}let S,k=this.footnotes.findIndex((M=>M.url===h));return k===-1?(this.footnoteCounter++,S=this.footnoteCounter,this.footnotes.push({url:h,text:`<a href="${h}">${C}</a>${E}`})):S=k+1,`<sup id="fnref:${S}"><a href="#fn:${S}">${S}</a></sup>`})),c=c.replace(/<p[^>]*>\s*<\/p>/g,""),t.push({author:i,content:c.trim(),metadata:{role:a||"unknown"}})})),t}getFootnotes(){return this.footnotes}getMetadata(){let t=this.getTitle(),o=this.extractMessages();return{title:t,site:"ChatGPT",url:this.url,messageCount:o.length,description:`ChatGPT conversation with ${o.length} messages`}}getTitle(){var t,o,r;let e=(t=this.document.title)===null||t===void 0?void 0:t.trim();if(e&&e!=="ChatGPT")return e;let n=(r=(o=this.articles)===null||o===void 0?void 0:o.item(0))===null||r===void 0?void 0:r.querySelector(".text-message");if(n){let i=n.textContent||"";return i.length>50?i.slice(0,50)+"...":i}return"ChatGPT Conversation"}}g.ChatGPTExtractor=p},640:(I,g)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.ALLOWED_ATTRIBUTES_DEBUG=g.ALLOWED_ATTRIBUTES=g.ALLOWED_EMPTY_ELEMENTS=g.FOOTNOTE_LIST_SELECTORS=g.FOOTNOTE_INLINE_REFERENCES=g.PARTIAL_SELECTORS=g.TEST_ATTRIBUTES=g.EXACT_SELECTORS=g.INLINE_ELEMENTS=g.PRESERVE_ELEMENTS=g.BLOCK_ELEMENTS=g.MOBILE_WIDTH=g.ENTRY_POINT_ELEMENTS=void 0,g.ENTRY_POINT_ELEMENTS=["#post",".post-content",".article-content","#article-content",".article_post",".article-wrapper",".entry-content",".content-article",".post",".markdown-body","article",'[role="article"]',"main",'[role="main"]',"body"],g.MOBILE_WIDTH=600,g.BLOCK_ELEMENTS=["div","section","article","main","aside","header","footer","nav","content"],g.PRESERVE_ELEMENTS=new Set(["pre","code","table","thead","tbody","tr","td","th","ul","ol","li","dl","dt","dd","figure","figcaption","picture","details","summary","blockquote","form","fieldset"]),g.INLINE_ELEMENTS=new Set(["a","span","strong","em","i","b","u","code","br","small","sub","sup","mark","date","del","ins","q","abbr","cite","relative-time","time","font"]),g.EXACT_SELECTORS=["noscript",'script:not([type^="math/"])',"style","meta","link",'.ad:not([class*="gradient"])','[class^="ad-" i]','[class$="-ad" i]','[id^="ad-" i]','[id$="-ad" i]','[role="banner" i]','[alt*="advert" i]',".promo",".Promo","#barrier-page",".alert",'[id="comments" i]','[id="comment" i]',"header",".header:not(.banner)","#header","#Header","#banner","#Banner","nav",".navigation","#navigation",".hero",'[role="navigation" i]','[role="dialog" i]','[role*="complementary" i]','[class*="pagination" i]',".menu","#menu","#siteSub",".previous",".author",".Author",'[class$="_bio"]',"#categories",".contributor",".date","#date","[data-date]",".entry-meta",".meta",".tags","#tags",".toc",".Toc","#toc",".headline","#headline","#title","#Title","#articleTag",'[href*="/category"]','[href*="/categories"]','[href*="/tag/"]','[href*="/tags/"]','[href*="/topics"]','[href*="author"]','[href*="#toc"]','[href="#top"]','[href="#Top"]','[href="#page-header"]','[href="#content"]','[href="#site-content"]','[href="#main-content"]','[href^="#main"]','[src*="author"]',"footer",".aside","aside","button","canvas","date","dialog","fieldset","form",'input:not([type="checkbox"])',"label","option","select","textarea","time","relative-time","[hidden]",'[aria-hidden="true"]:not([class*="math"])','[style*="display: none"]:not([class*="math"])','[style*="display:none"]:not([class*="math"])','[style*="visibility: hidden"]','[style*="visibility:hidden"]',".hidden",".invisible","instaread-player",'iframe:not([src*="youtube"]):not([src*="youtu.be"]):not([src*="vimeo"]):not([src*="twitter"]):not([src*="x.com"]):not([src*="datawrapper"])','[class="logo" i]',"#logo","#Logo","#newsletter","#Newsletter",".subscribe",".noprint",'[data-print-layout="hide" i]','[data-block="donotprint" i]','[class*="clickable-icon" i]','li span[class*="ltx_tag" i][class*="ltx_tag_item" i]','a[href^="#"][class*="anchor" i]','a[href^="#"][class*="ref" i]','[data-container*="most-viewed" i]',".sidebar",".Sidebar","#sidebar","#Sidebar","#sitesub",'[data-link-name*="skip" i]','[aria-label*="skip" i]',".copyright","#copyright","#rss","#feed",".gutter","#primaryaudio","#NYT_ABOVE_MAIN_CONTENT_REGION",'[data-testid="photoviewer-children-figure"] > span',"table.infobox",".pencraft:not(.pc-display-contents)",'[data-optimizely="related-articles-section" i]','[data-orientation="vertical"]',".gh-header-sticky",'[data-testid="issue-metadata-sticky"]'],g.TEST_ATTRIBUTES=["class","id","data-test","data-testid","data-test-id","data-qa","data-cy"],g.PARTIAL_SELECTORS=["a-statement","access-wall","activitypub","actioncall","addcomment","advert","adlayout","ad-tldr","ad-placement","ads-container","_ad_","after_content","after_main_article","afterpost","allterms","-alert-","alert-box","appendix","_archive","around-the-web","aroundpages","article-author","article-badges","article-banner","article-bottom-section","article-bottom","article-category","article-card","article-citation","article__copy","article_date","article-date","article-end ","article_header","article-header","article__header","article__hero","article__info","article-info","article-meta","article_meta","article__meta","articlename","article-subject","article_subject","article-snippet","article-separator","article--share","article--topics","articletags","article-tags","article_tags","articletitle","article-title","article_title","articletopics","article-topics","article--lede","articlewell","associated-people","audio-card","author-bio","author-box","author-info","author_info","authorm","author-mini-bio","author-name","author-publish-info","authored-by","avatar","back-to-top","backlink_container","backlinks-section","bio-block","biobox","blog-pager","bookmark-","-bookmark","bottominfo","bottomnav","bottom-of-article","bottom-wrapper","brand-bar","breadcrumb","brdcrumb","button-wrapper","buttons-container","btn-","-btn","byline","captcha","card-text","card-media","card-post","carouselcontainer","carousel-container","cat_header","catlinks","_categories","card-author","card-content","chapter-list","collections","comments","commentbox","comment-button","commentcomp","comment-content","comment-count","comment-form","comment-number","comment-respond","comment-thread","comment-wrap","complementary","consent","contact-","content-card","content-topics","contentpromo","context-bar","context-widget","core-collateral","cover-","created-date","creative-commons_","c-subscribe","_cta","-cta","cta-","cta_","current-issue","custom-list-number","dateline","dateheader","date-header","date-pub","disclaimer","disclosure","discussion","discuss_","disqus","donate","donation","dropdown","eletters","emailsignup","engagement-widget","enhancement","entry-author-info","entry-categories","entry-date","entry-title","entry-utility","-error","error-","eyebrow","expand-reduce","external-anchor","externallinkembedwrapper","extra-services","extra-title","facebook","fancy-box","favorite","featured-content","feature_feed","feedback","feed-links","field-site-sections","fixheader","floating-vid","follower","footer","footnote-back","footnoteback","form-group","for-you","frontmatter","further-reading","fullbleedheader","gated-","gh-feed","gist-meta","goog-","graph-view","hamburger","header_logo","header-logo","header-pattern","hero-list","hide-for-print","hide-print","hide-when-no-script","hidden-print","hidden-sidenote","hidden-accessibility","infoline","instacartIntegration","interlude","interaction","itemendrow","invisible","jumplink","jump-to-","js-skip-to-content","keepreading","keep-reading","keep_reading","keyword_wrap","kicker","labstab","-labels","language-name","lastupdated","latest-content","-ledes-","-license","license-","lightbox-popup","like-button","link-box","links-grid","links-title","listing-dynamic-terms","list-tags","listinks","loading","loa-info","logo_container","ltx_role_refnum","ltx_tag_bibitem","ltx_error","masthead","marketing","media-inquiry","-menu","menu-","metadata","might-like","minibio","more-about","_modal","-modal","more-","morenews","morestories","more_wrapper","most-read","move-helper","mw-editsection","mw-cite-backlink","mw-indicators","mw-jump-link","nav-","nav_","navigation-post","next-","newsgallery","news-story-title","newsletter_","newsletterbanner","newslettercontainer","newsletter-form","newsletter-signup","newslettersignup","newsletterwidget","newsletterwrapper","not-found","notessection","nomobile","noprint","open-slideshow","originally-published","other-blogs","outline-view","pagehead","page-header","page-title","paywall_message","-partners","permission-","plea","popular","popup_links","pop_stories","pop-up","post-author","post-bottom","post__category","postcomment","postdate","post-date","post_date","post-details","post-feeds","postinfo","post-info","post_info","post-inline-date","post-links","postlist","post_list","post_meta","post-meta","postmeta","post_more","postnavi","post-navigation","postpath","post-preview","postsnippet","post_snippet","post-snippet","post-subject","posttax","post-tax","post_tax","posttag","post_tag","post-tag","post_time","posttitle","post-title","post_title","post__title","post-ufi-button","prev-post","prevnext","prev_next","prev-next","previousnext","press-inquiries","print-none","print-header","print:hidden","privacy-notice","privacy-settings","profile","promo_article","promo-bar","promo-box","pubdate","pub_date","pub-date","publish_date","publish-date","publication-date","publicationName","qr-code","qr_code","quick_up","_rail","ratingssection","read_also","readmore","read-next","read_next","read_time","read-time","reading_time","reading-time","reading-list","recent-","recent-articles","recentpost","recent_post","recent-post","recommend","redirectedfrom","recirc","register","related","relevant","reversefootnote","_rss","rss-link","screen-reader-text","scroll_to","scroll-to","_search","-search","section-nav","series-banner","share-box","sharedaddy","share-icons","sharelinks","share-post","share-print","share-section","show-for-print","sidebartitle","sidebar-content","sidebar-wrapper","sideitems","sidebar-author","sidebar-item","side-box","side-logo","sign-in-gate","similar-","similar_","similars-","site-index","site-header","siteheader","site-logo","site-name","site-wordpress","skip-content","skip-to-content","skip-link","c-skip-link","_skip-link","-slider","slug-wrap","social-author","social-shar","social-date","speechify-ignore","speedbump","sponsor","springercitation","sr-only","_stats","story-date","story-navigation","storyreadtime","storysmall","storypublishdate","subject-label","subhead","submenu","-subscribe-","subscriber-drive","subscription-","_tags","tags__item","tag_list","taxonomy","table-of-contents","tabs-","terminaltout","time-rubric","timestamp","time-read","time-to-read","tip_off","tiptout","-tout-","toc-container","toggle-caption","tooltip","topbar","topic-list","topic-subnav","top-wrapper","tree-item","trending","trust-feat","trust-badge","trust-project","twitter","u-hide","upsell","viewbottom","visually-hidden","welcomebox","widget_pages"],g.FOOTNOTE_INLINE_REFERENCES=["sup.reference","cite.ltx_cite",'sup[id^="fnr"]','span[id^="fnr"]','span[class*="footnote_ref"]',"span.footnote-link","a.citation",'a[id^="ref-link"]','a[href^="#fn"]','a[href^="#cite"]','a[href^="#reference"]','a[href^="#footnote"]','a[href^="#r"]','a[href^="#b"]','a[href*="cite_note"]','a[href*="cite_ref"]',"a.footnote-anchor","span.footnote-hovercard-target a",'a[role="doc-biblioref"]','a[id^="fnref"]','a[id^="ref-link"]'].join(","),g.FOOTNOTE_LIST_SELECTORS=["div.footnote ol","div.footnotes ol",'div[role="doc-endnotes"]','div[role="doc-footnotes"]',"ol.footnotes-list","ol.footnotes","ol.references",'ol[class*="article-references"]',"section.footnotes ol",'section[role="doc-endnotes"]','section[role="doc-footnotes"]','section[role="doc-bibliography"]',"ul.footnotes-list","ul.ltx_biblist",'div.footnote[data-component-name="FootnoteToDOM"]'].join(","),g.ALLOWED_EMPTY_ELEMENTS=new Set(["area","audio","base","br","circle","col","defs","ellipse","embed","figure","g","hr","iframe","img","input","line","link","mask","meta","object","param","path","pattern","picture","polygon","polyline","rect","source","stop","svg","td","th","track","use","video","wbr"]),g.ALLOWED_ATTRIBUTES=new Set(["alt","allow","allowfullscreen","aria-label","checked","colspan","controls","data-latex","data-src","data-srcset","data-lang","dir","display","frameborder","headers","height","href","lang","role","rowspan","src","srcset","title","type","width","accent","accentunder","align","columnalign","columnlines","columnspacing","columnspan","data-mjx-texclass","depth","displaystyle","fence","frame","framespacing","linethickness","lspace","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","rowalign","rowlines","rowspacing","rowspan","rspace","scriptlevel","separator","stretchy","symmetric","voffset","xmlns"]),g.ALLOWED_ATTRIBUTES_DEBUG=new Set(["class","id"])},649:(I,g,m)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.imageRules=void 0;let f=m(552),p=/^data:image\/([^;]+);base64,/,w=/\.(jpg|jpeg|png|webp)\s+\d/,t=/^\s*\S+\.(jpg|jpeg|png|webp)\S*\s*$/,o=/\.(jpg|jpeg|png|webp|gif|avif)(\?.*)?$/i,r=/\s(\d+)w/,e=/dpr=(\d+(?:\.\d+)?)/,n=/^([^\s]+)/,i=/^[\w\-\.\/\\]+\.(jpg|jpeg|png|gif|webp|svg)$/i,a=/^\d{4}-\d{2}-\d{2}$/;function l(s,x,y){let T=y.createElement("figure");T.appendChild(s.cloneNode(!0));let L=y.createElement("figcaption"),N=(function(A){let _=[],O=new Set,H=D=>{var R;if((0,f.isTextNode)(D)){let B=((R=D.textContent)===null||R===void 0?void 0:R.trim())||"";B&&!O.has(B)&&(_.push(B),O.add(B))}else if((0,f.isElement)(D)){let B=D.childNodes;for(let W=0;W<B.length;W++)H(B[W])}},P=A.childNodes;for(let D=0;D<P.length;D++)H(P[D]);return _.length>0?_.join(" "):A.innerHTML})(x);return L.innerHTML=N,T.appendChild(L),T}function c(s,x){x.setAttribute("srcset",s);let y=q(s);y&&b(y)&&x.setAttribute("src",y)}function u(s,x,y){for(let T=0;T<s.attributes.length;T++){let L=s.attributes[T];y.includes(L.name)||x.setAttribute(L.name,L.value)}}function v(s){let x=s.match(p);if(!x||x[1]==="svg+xml")return!1;let y=x[0].length;return s.length-y<133}function d(s){return s.startsWith("data:image/svg+xml")}function b(s){return!s.startsWith("data:")&&!(!s||s.trim()==="")&&(o.test(s)||s.includes("image")||s.includes("img")||s.includes("photo"))}function h(s){return C(s)?!0:s.querySelectorAll("img, video, picture, source").length>0}function C(s){let x=s.tagName.toLowerCase();return x==="img"||x==="video"||x==="picture"||x==="source"}function E(s){if(C(s))return s;let x=s.querySelectorAll("picture");if(x.length>0)return x[0];let y=s.querySelectorAll("img"),T=[];for(let _=0;_<y.length;_++){let O=y[_],H=O.getAttribute("src")||"",P=O.getAttribute("alt")||"";H.includes("data:image/svg+xml")||v(H)||!P.trim()&&y.length>1||T.push(O)}if(T.length>0)return T[0];let L=s.querySelectorAll("video");if(L.length>0)return L[0];let N=s.querySelectorAll("source");if(N.length>0)return N[0];let A=s.querySelectorAll("img, picture, source, video");return A.length>0?A[0]:null}function S(s){var x,y,T,L;let N=s.querySelector("figcaption");if(N)return N;let A=new Set,_=['[class*="caption"]','[class*="description"]','[class*="alt"]','[class*="title"]','[class*="credit"]','[class*="text"]','[class*="post-thumbnail-text"]','[class*="image-caption"]','[class*="photo-caption"]',"[aria-label]","[title]"].join(", "),O=s.querySelectorAll(_);for(let D=0;D<O.length;D++){let R=O[D];if(C(R))continue;let B=(x=R.textContent)===null||x===void 0?void 0:x.trim();if(B&&B.length>0&&!A.has(B))return A.add(B),R}let H=s.querySelector("img");if(H&&H.hasAttribute("alt")){let D=H.getAttribute("alt");if(D&&D.trim().length>0){let R=s.ownerDocument.createElement("div");return R.textContent=D,R}}if(s.parentElement){let D=s.parentElement.children;for(let R=0;R<D.length;R++){let B=D[R];if(B!==s&&Array.from(B.classList).some((W=>W.includes("caption")||W.includes("credit")||W.includes("text")||W.includes("description")))){let W=(y=B.textContent)===null||y===void 0?void 0:y.trim();if(W&&W.length>0)return B}}}let P=s.querySelectorAll("img");for(let D=0;D<P.length;D++){let R=P[D];if(!R.parentElement)continue;let B=R.nextElementSibling;for(;B;){if(["EM","STRONG","SPAN","I","B","SMALL","CITE"].includes(B.tagName)){let W=(T=B.textContent)===null||T===void 0?void 0:T.trim();if(W&&W.length>0)return B}B=B.nextElementSibling}}for(let D=0;D<P.length;D++){let R=P[D],B=R.parentElement;if(!B)continue;let W=B.querySelectorAll("em, strong, span, i, b, small, cite");for(let V=0;V<W.length;V++){let J=W[V];if(J===R)continue;let X=(L=J.textContent)===null||L===void 0?void 0:L.trim();if(X&&X.length>0)return J}}return null}function k(s){var x;let y=((x=s.textContent)===null||x===void 0?void 0:x.trim())||"";return!(y.length<10||y.startsWith("http://")||y.startsWith("https://"))&&!i.test(y)&&!y.match(/^\d+$/)&&!a.test(y)}function M(s,x){let y=s.tagName.toLowerCase();if(y==="img")return $(s,x);if(y==="picture"){let T=s.querySelector("img");return T?$(T,x):s.cloneNode(!0)}return y==="source"?(function(T,L){let N=L.createElement("img"),A=T.getAttribute("srcset");A&&c(A,N);let _=T.parentElement;if(_){let O=_.querySelectorAll("img"),H=[];for(let P=0;P<O.length;P++){let D=O[P],R=D.getAttribute("src")||"";v(R)||d(R)||R===""||H.push(D)}if(H.length>0){if(u(H[0],N,["src","srcset"]),!N.hasAttribute("src")||!b(N.getAttribute("src")||"")){let P=H[0].getAttribute("src");P&&b(P)&&N.setAttribute("src",P)}}else{let P=_.querySelector("img[data-src]");if(P&&(u(P,N,["src","srcset"]),!N.hasAttribute("src")||!b(N.getAttribute("src")||""))){let D=P.getAttribute("data-src");D&&b(D)&&N.setAttribute("src",D)}}}return N})(s,x):s.cloneNode(!0)}function $(s,x){let y=s.getAttribute("src")||"";if(v(y)||d(y)){let T=s.parentElement;if(T){let L=T.querySelectorAll("source"),N=[];for(let A=0;A<L.length;A++){let _=L[A];_.hasAttribute("data-srcset")&&_.getAttribute("data-srcset")!==""&&N.push(_)}if(N.length>0){let A=x.createElement("img"),_=s.getAttribute("data-src");return _&&!d(_)&&A.setAttribute("src",_),u(s,A,["src"]),A}}}return s.cloneNode(!0)}function q(s){let x=s.split(",");if(x.length===0)return null;let y=x[0].trim().match(n);if(y&&y[1]){let T=y[1];if(d(T)){for(let L=1;L<x.length;L++){let N=x[L].trim().match(n);if(N&&N[1]&&!d(N[1]))return N[1]}return null}return T}return null}function j(s){if(s.length===0)return null;if(s.length===1)return s[0];for(let T=0;T<s.length;T++)if(!s[T].hasAttribute("media"))return s[T];let x=null,y=0;for(let T=0;T<s.length;T++){let L=s[T],N=L.getAttribute("srcset");if(!N)continue;let A=N.match(r),_=N.match(e);if(A&&A[1]){let O=parseInt(A[1],10)*(_?parseFloat(_[1]):1);O>y&&(y=O,x=L)}}return x||s[0]}g.imageRules=[{selector:"picture",element:"picture",transform:(s,x)=>{let y=s.querySelectorAll("source"),T=s.querySelector("img");if(!T){console.warn("Picture element without img fallback:",s.outerHTML);let A=j(y);if(A){let _=A.getAttribute("srcset");if(_){let O=x.createElement("img");return c(_,O),s.innerHTML="",s.appendChild(O),s}}return s}let L=null,N=null;if(y.length>0){let A=j(y);A&&(L=A.getAttribute("srcset"),L&&(N=q(L)))}if(L&&T.setAttribute("srcset",L),N&&b(N))T.setAttribute("src",N);else if(!T.hasAttribute("src")||!b(T.getAttribute("src")||"")){let A=q(T.getAttribute("srcset")||L||"");A&&b(A)&&T.setAttribute("src",A)}return y.forEach((A=>A.remove())),s}},{selector:"uni-image-full-width",element:"figure",transform:(s,x)=>{var y;let T=x.createElement("figure"),L=x.createElement("img"),N=s.querySelector("img");if(!N)return console.warn("uni-image-full-width without img:",s.outerHTML),T;let A=N.getAttribute("src"),_=N.getAttribute("data-loading");if(_)try{let P=JSON.parse(_);P.desktop&&b(P.desktop)&&(A=P.desktop)}catch(P){console.warn("Failed to parse data-loading attribute:",_,P)}if(!A||!b(A))return console.warn("Could not find valid src for uni-image-full-width:",s.outerHTML),T;L.setAttribute("src",A);let O=N.getAttribute("alt");O||(O=s.getAttribute("alt-text")),O&&L.setAttribute("alt",O),T.appendChild(L);let H=s.querySelector("figcaption");if(H){let P=(y=H.textContent)===null||y===void 0?void 0:y.trim();if(P&&P.length>5){let D=x.createElement("figcaption"),R=H.querySelector(".rich-text p");R?D.innerHTML=R.innerHTML:D.textContent=P,T.appendChild(D)}}return T}},{selector:'img[data-src], img[data-srcset], img[loading="lazy"], img.lazy, img.lazyload',element:"img",transform:(s,x)=>{let y=s.getAttribute("src")||"",T=(function(A){if(A.hasAttribute("data-src")||A.hasAttribute("data-srcset"))return!0;for(let _=0;_<A.attributes.length;_++){let O=A.attributes[_];if(O.name!=="src"&&(O.name.startsWith("data-")&&/\.(jpg|jpeg|png|webp|gif)(\?.*)?$/i.test(O.value)||/\.(jpg|jpeg|png|webp|gif)(\?.*)?$/i.test(O.value)))return!0}return!1})(s);v(y)&&T&&s.removeAttribute("src");let L=s.getAttribute("data-src");L&&!s.getAttribute("src")&&s.setAttribute("src",L);let N=s.getAttribute("data-srcset");N&&!s.getAttribute("srcset")&&s.setAttribute("srcset",N);for(let A=0;A<s.attributes.length;A++){let _=s.attributes[A];_.name!=="src"&&_.name!=="srcset"&&_.name!=="alt"&&(w.test(_.value)?s.setAttribute("srcset",_.value):t.test(_.value)&&s.setAttribute("src",_.value))}return s.classList.remove("lazy","lazyload"),s.removeAttribute("data-ll-status"),s.removeAttribute("data-src"),s.removeAttribute("data-srcset"),s.removeAttribute("loading"),s}},{selector:"span:has(img)",element:"span",transform:(s,x)=>{try{if(!h(s))return s;let y=E(s);if(!y)return s;let T=S(s),L=M(y,x);if(T&&k(T)){let N=l(L,T,x);return T.parentNode&&T.parentNode.removeChild(T),N}return L}catch(y){return console.warn("Error processing span with image:",y),s}}},{selector:'figure, p:has([class*="caption"])',element:"figure",transform:(s,x)=>{try{if(!h(s))return s;let y=E(s);if(!y)return s;let T=S(s);if(T&&k(T)){let L=E(s),N;return L?N=L:(console.warn("Figure rule couldn't find current image element in:",s.outerHTML),N=M(y,x)),l(N,T,x)}return s}catch(y){return console.warn("Error processing complex image element:",y),s}}}]},732:(I,g,m)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.GeminiExtractor=void 0;let f=m(181);class p extends f.ConversationExtractor{constructor(t,o){super(t,o),this.messageCount=null,this.conversationContainers=t.querySelectorAll("div.conversation-container"),this.footnotes=[]}canExtract(){return!!this.conversationContainers&&this.conversationContainers.length>0}extractMessages(){this.messageCount=0;let t=[];return this.conversationContainers&&(this.extractSources(),this.conversationContainers.forEach((o=>{let r=o.querySelector("user-query");if(r){let n=r.querySelector(".query-text");if(n){let i=n.innerHTML||"";t.push({author:"You",content:i.trim(),metadata:{role:"user"}})}}let e=o.querySelector("model-response");if(e){let n=e.querySelector(".model-response-text .markdown"),i=e.querySelector("#extended-response-markdown-content")||n;if(i){let a=i.innerHTML||"",l=document.createElement("div");l.innerHTML=a,l.querySelectorAll(".table-content").forEach((c=>{c.classList.remove("table-content")})),a=l.innerHTML,t.push({author:"Gemini",content:a.trim(),metadata:{role:"assistant"}})}}})),this.messageCount=t.length),t}extractSources(){let t=this.document.querySelectorAll("browse-item");t&&t.length>0&&t.forEach((o=>{var r,e,n,i;let a=o.querySelector("a");if(a instanceof HTMLAnchorElement){let l=a.href,c=((e=(r=a.querySelector(".domain"))===null||r===void 0?void 0:r.textContent)===null||e===void 0?void 0:e.trim())||"",u=((i=(n=a.querySelector(".title"))===null||n===void 0?void 0:n.textContent)===null||i===void 0?void 0:i.trim())||"";l&&(c||u)&&this.footnotes.push({url:l,text:u?`${c}: ${u}`:c})}}))}getFootnotes(){return this.footnotes}getMetadata(){var t;let o=this.getTitle(),r=(t=this.messageCount)!==null&&t!==void 0?t:this.extractMessages().length;return{title:o,site:"Gemini",url:this.url,messageCount:r,description:`Gemini conversation with ${r} messages`}}getTitle(){var t,o,r,e,n;let i=(t=this.document.title)===null||t===void 0?void 0:t.trim();if(i&&i!=="Gemini"&&!i.includes("Gemini"))return i;let a=(r=(o=this.document.querySelector(".title-text"))===null||o===void 0?void 0:o.textContent)===null||r===void 0?void 0:r.trim();if(a)return a;let l=(n=(e=this.conversationContainers)===null||e===void 0?void 0:e.item(0))===null||n===void 0?void 0:n.querySelector(".query-text");if(l){let c=l.textContent||"";return c.length>50?c.slice(0,50)+"...":c}return"Gemini Conversation"}}g.GeminiExtractor=p},754:(I,g,m)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.codeBlockRules=void 0;let f=m(552),p=[/^language-(\w+)$/,/^lang-(\w+)$/,/^(\w+)-code$/,/^code-(\w+)$/,/^syntax-(\w+)$/,/^code-snippet__(\w+)$/,/^highlight-(\w+)$/,/^(\w+)-snippet$/,/(?:^|\s)(?:language|lang|brush|syntax)-(\w+)(?:\s|$)/i],w=new Set(["abap","actionscript","ada","adoc","agda","antlr4","applescript","arduino","armasm","asciidoc","aspnet","atom","bash","batch","c","clojure","cmake","cobol","coffeescript","cpp","c++","crystal","csharp","cs","dart","django","dockerfile","dotnet","elixir","elm","erlang","fortran","fsharp","gdscript","gitignore","glsl","golang","gradle","graphql","groovy","haskell","hs","haxe","hlsl","html","idris","java","javascript","js","jsx","jsdoc","json","jsonp","julia","kotlin","latex","lisp","elisp","livescript","lua","makefile","markdown","md","markup","masm","mathml","matlab","mongodb","mysql","nasm","nginx","nim","nix","objc","ocaml","pascal","perl","php","postgresql","powershell","prolog","puppet","python","regex","rss","ruby","rb","rust","scala","scheme","shell","sh","solidity","sparql","sql","ssml","svg","swift","tcl","terraform","tex","toml","typescript","ts","tsx","unrealscript","verilog","vhdl","webassembly","wasm","xml","yaml","yml","zig"]);g.codeBlockRules=[{selector:["pre",'div[class*="prismjs"]',".syntaxhighlighter",".highlight",".highlight-source",".wp-block-syntaxhighlighter-code",".wp-block-code",'div[class*="language-"]'].join(", "),element:"pre",transform:(t,o)=>{if(!(u=>"classList"in u&&"getAttribute"in u&&"querySelector"in u)(t))return t;let r=u=>{var v;let d=u.getAttribute("data-lang")||u.getAttribute("data-language");if(d)return d.toLowerCase();let b=Array.from(u.classList||[]);if(!((v=u.classList)===null||v===void 0)&&v.contains("syntaxhighlighter")){let h=b.find((C=>!["syntaxhighlighter","nogutter"].includes(C)));if(h&&w.has(h.toLowerCase()))return h.toLowerCase()}for(let h of b)for(let C of p){let E=h.toLowerCase().match(C);if(E&&E[1]&&w.has(E[1].toLowerCase()))return E[1].toLowerCase()}for(let h of b)if(w.has(h.toLowerCase()))return h.toLowerCase();return""},e="",n=t;for(;n&&!e;){e=r(n);let u=n.querySelector("code");!e&&u&&(e=r(u)),n=n.parentElement}let i=u=>{if((0,f.isTextNode)(u))return u.textContent||"";let v="";if((0,f.isElement)(u)){if(u.tagName==="BR")return`
`;if(u.matches('div[class*="line"], span[class*="line"], .ec-line, [data-line-number], [data-line]')){let d=u.querySelector('.code, .content, [class*="code-"], [class*="content-"]');if(d)return(d.textContent||"")+`
`;let b=u.querySelector('.line-number, .gutter, [class*="line-number"], [class*="gutter"]');return b?Array.from(u.childNodes).filter((h=>!b.contains(h))).map((h=>i(h))).join("")+`
`:u.textContent+`
`}u.childNodes.forEach((d=>{v+=i(d)}))}return v},a="";t.matches(".syntaxhighlighter, .wp-block-syntaxhighlighter-code")&&(a=(u=>{let v=u.querySelector(".syntaxhighlighter table .code .container");if(v)return Array.from(v.children).map((b=>Array.from(b.querySelectorAll("code")).map((C=>{var E;let S=C.textContent||"";return!((E=C.classList)===null||E===void 0)&&E.contains("spaces")&&(S=" ".repeat(S.length)),S})).join("")||b.textContent||"")).join(`
`);let d=u.querySelectorAll(".code .line");return d.length>0?Array.from(d).map((b=>Array.from(b.querySelectorAll("code")).map((C=>C.textContent||"")).join("")||b.textContent||"")).join(`
`):""})(t)),a||(a=i(t)),a=a.replace(/^\s+|\s+$/g,"").replace(/\t/g,"    ").replace(/\n{3,}/g,`

`).replace(/\u00a0/g," ").replace(/^\n+/,"").replace(/\n+$/,"");let l=o.createElement("pre"),c=o.createElement("code");return e&&(c.setAttribute("data-lang",e),c.setAttribute("class",`language-${e}`)),c.textContent=a,l.appendChild(c),l}}]},840:(I,g,m)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.standardizeContent=function(u,v,d,b=!1){(function(h){let C=E=>{if((0,e.isElement)(E)){let S=E.tagName.toLowerCase();if(S==="pre"||S==="code")return}if((0,e.isTextNode)(E)){let S=E.textContent||"",k=S.replace(/\xA0+/g,(M=>{var $,q,j,s;if(M.length===1){let x=(q=($=E.previousSibling)===null||$===void 0?void 0:$.textContent)===null||q===void 0?void 0:q.slice(-1),y=(s=(j=E.nextSibling)===null||j===void 0?void 0:j.textContent)===null||s===void 0?void 0:s.charAt(0);if(x?.match(/\w/)&&y?.match(/\w/))return"\xA0"}return" ".repeat(M.length)}));k!==S&&(E.textContent=k)}E.hasChildNodes()&&Array.from(E.childNodes).forEach(C)};C(h)})(u),(function(h){let C=0;Array.from(h.getElementsByTagName("*")).forEach((E=>{Array.from(E.childNodes).forEach((S=>{(0,e.isCommentNode)(S)&&(S.remove(),C++)}))})),(0,e.logDebug)("Removed HTML comments:",C)})(u),(function(h,C,E){let S=$=>$.replace(/\u00A0/g," ").replace(/\s+/g," ").trim().toLowerCase(),k=h.getElementsByTagName("h1");Array.from(k).forEach(($=>{var q;let j=E.createElement("h2");j.innerHTML=$.innerHTML,Array.from($.attributes).forEach((s=>{f.ALLOWED_ATTRIBUTES.has(s.name)&&j.setAttribute(s.name,s.value)})),(q=$.parentNode)===null||q===void 0||q.replaceChild(j,$)}));let M=h.getElementsByTagName("h2");if(M.length>0){let $=M[0],q=S($.textContent||""),j=S(C);j&&j===q&&$.remove()}})(u,v.title,d),(0,t.standardizeFootnotes)(u),(function(h,C){let E=0;n.forEach((S=>{h.querySelectorAll(S.selector).forEach((k=>{if(S.transform){let M=S.transform(k,C);k.replaceWith(M),E++}}))})),h.querySelectorAll("lite-youtube").forEach((S=>{let k=S.getAttribute("videoid");if(!k)return;let M=C.createElement("iframe");M.width="560",M.height="315",M.src=`https://www.youtube.com/embed/${k}`,M.title=S.getAttribute("videotitle")||"YouTube video player",M.frameBorder="0",M.allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",M.setAttribute("allowfullscreen",""),S.replaceWith(M),E++})),(0,e.logDebug)("Converted embedded elements:",E)})(u,d),b?(a(u,b),i(u),l(u),(0,e.logDebug)("Debug mode: Skipping div flattening to preserve structure")):(c(u,d),a(u,b),(function(h){let C=0,E=0,S=!0;for(;S;){E++,S=!1;let k=Array.from(h.getElementsByTagName("*")).filter((M=>{if(f.ALLOWED_EMPTY_ELEMENTS.has(M.tagName.toLowerCase()))return!1;let $=M.textContent||"",q=$.trim().length===0,j=$.includes("\xA0"),s=!M.hasChildNodes()||Array.from(M.childNodes).every((x=>{if((0,e.isTextNode)(x)){let y=x.textContent||"";return y.trim().length===0&&!y.includes("\xA0")}return!1}));if(M.tagName.toLowerCase()==="div"){let x=Array.from(M.children);if(x.length>0&&x.every((y=>{var T;if(y.tagName.toLowerCase()!=="span")return!1;let L=((T=y.textContent)===null||T===void 0?void 0:T.trim())||"";return L===","||L===""||L===" "})))return!0}return q&&!j&&s}));k.length>0&&(k.forEach((M=>{M.remove(),C++})),S=!0)}(0,e.logDebug)("Removed empty elements:",C,"iterations:",E)})(u),i(u),c(u,d),l(u),(function(h,C){let E=0,S=Date.now(),k=q=>{var j;if((0,e.isElement)(q)){let s=q.tagName.toLowerCase();if(s==="pre"||s==="code")return}if(Array.from(q.childNodes).forEach(k),(0,e.isTextNode)(q)){let s=q.textContent||"";if(!s||s.match(/^[\u200C\u200B\u200D\u200E\u200F\uFEFF\xA0\s]*$/))(j=q.parentNode)===null||j===void 0||j.removeChild(q),E++;else{let x=s.replace(/\n{3,}/g,`

`).replace(/^[\n\r\t]+/,"").replace(/[\n\r\t]+$/,"").replace(/[ \t]*\n[ \t]*/g,`
`).replace(/[ \t]{3,}/g," ").replace(/^[ ]+$/," ").replace(/\s+([,.!?:;])/g,"$1").replace(/[\u200C\u200B\u200D\u200E\u200F\uFEFF]+/g,"").replace(/(?:\xA0){2,}/g,"\xA0");x!==s&&(q.textContent=x,E+=s.length-x.length)}}},M=q=>{var j;if(!(0,e.isElement)(q))return;let s=q.tagName.toLowerCase();if(s==="pre"||s==="code")return;Array.from(q.childNodes).filter(e.isElement).forEach(M),q.normalize();let x=((j=(0,e.getComputedStyle)(q))===null||j===void 0?void 0:j.display)==="block",y=x?/^[\n\r\t \u200C\u200B\u200D\u200E\u200F\uFEFF\xA0]*$/:/^[\n\r\t\u200C\u200B\u200D\u200E\u200F\uFEFF]*$/,T=x?/^[\n\r\t \u200C\u200B\u200D\u200E\u200F\uFEFF\xA0]*$/:/^[\n\r\t\u200C\u200B\u200D\u200E\u200F\uFEFF]*$/;for(;q.firstChild&&(0,e.isTextNode)(q.firstChild)&&(q.firstChild.textContent||"").match(y);)q.removeChild(q.firstChild),E++;for(;q.lastChild&&(0,e.isTextNode)(q.lastChild)&&(q.lastChild.textContent||"").match(T);)q.removeChild(q.lastChild),E++;if(!x){let L=Array.from(q.childNodes);for(let N=0;N<L.length-1;N++){let A=L[N],_=L[N+1];if((0,e.isElement)(A)||(0,e.isElement)(_)){let O=_.textContent||"",H=A.textContent||"",P=O.match(/^[,.!?:;)\]]/),D=H.match(/[,.!?:;(\[]\s*$/),R=(0,e.isTextNode)(A)&&(A.textContent||"").endsWith(" ")||(0,e.isTextNode)(_)&&(_.textContent||"").startsWith(" ");if(!P&&!D&&!R){let B=C.createTextNode(" ");q.insertBefore(B,_)}}}}};k(h),M(h);let $=Date.now();(0,e.logDebug)("Removed empty lines:",{charactersRemoved:E,processingTime:`${($-S).toFixed(2)}ms`})})(u,d))};let f=m(640),p=m(0),w=m(754),t=m(610),o=m(864),r=m(649),e=m(552),n=[...p.mathRules,...w.codeBlockRules,...o.headingRules,...r.imageRules,{selector:'div[data-testid^="paragraph"], div[role="paragraph"]',element:"p",transform:(u,v)=>{let d=v.createElement("p");return d.innerHTML=u.innerHTML,Array.from(u.attributes).forEach((b=>{f.ALLOWED_ATTRIBUTES.has(b.name)&&d.setAttribute(b.name,b.value)})),d}},{selector:'div[role="list"]',element:"ul",transform:(u,v)=>{var d;let b=u.querySelector('div[role="listitem"] .label'),h=(((d=b?.textContent)===null||d===void 0?void 0:d.trim())||"").match(/^\d+\)/),C=v.createElement(h?"ol":"ul");return u.querySelectorAll('div[role="listitem"]').forEach((E=>{let S=v.createElement("li"),k=E.querySelector(".content");k&&(k.querySelectorAll('div[role="paragraph"]').forEach((M=>{let $=v.createElement("p");$.innerHTML=M.innerHTML,M.replaceWith($)})),k.querySelectorAll('div[role="list"]').forEach((M=>{var $;let q=M.querySelector('div[role="listitem"] .label'),j=((($=q?.textContent)===null||$===void 0?void 0:$.trim())||"").match(/^\d+\)/),s=v.createElement(j?"ol":"ul");M.querySelectorAll('div[role="listitem"]').forEach((x=>{let y=v.createElement("li"),T=x.querySelector(".content");T&&(T.querySelectorAll('div[role="paragraph"]').forEach((L=>{let N=v.createElement("p");N.innerHTML=L.innerHTML,L.replaceWith(N)})),y.innerHTML=T.innerHTML),s.appendChild(y)})),M.replaceWith(s)})),S.innerHTML=k.innerHTML),C.appendChild(S)})),C}},{selector:'div[role="listitem"]',element:"li",transform:(u,v)=>{let d=u.querySelector(".content");return d?(d.querySelectorAll('div[role="paragraph"]').forEach((b=>{let h=v.createElement("p");h.innerHTML=b.innerHTML,b.replaceWith(h)})),d):u}}];function i(u){let v=0,d=b=>{let h="",C=b.nextSibling;for(;C;)((0,e.isTextNode)(C)||(0,e.isElement)(C))&&(h+=C.textContent||""),C=C.nextSibling;if(h.trim())return!0;let E=b.parentElement;return!(!E||E===u)&&d(E)};Array.from(u.querySelectorAll("h1, h2, h3, h4, h5, h6")).reverse().forEach((b=>{d(b)||(b.remove(),v++)})),v>0&&(0,e.logDebug)("Removed trailing headings:",v)}function a(u,v){let d=0,b=h=>{if(h.tagName.toLowerCase()==="svg"||h.namespaceURI==="http://www.w3.org/2000/svg")return;let C=Array.from(h.attributes),E=h.tagName.toLowerCase();C.forEach((S=>{let k=S.name.toLowerCase(),M=S.value;k==="id"&&(M.startsWith("fnref:")||M.startsWith("fn:")||M==="footnotes")||k==="class"&&(E==="code"&&M.startsWith("language-")||M==="footnote-backref")||(v?f.ALLOWED_ATTRIBUTES.has(k)||f.ALLOWED_ATTRIBUTES_DEBUG.has(k)||k.startsWith("data-")||(h.removeAttribute(S.name),d++):f.ALLOWED_ATTRIBUTES.has(k)||(h.removeAttribute(S.name),d++))}))};b(u),u.querySelectorAll("*").forEach(b),(0,e.logDebug)("Stripped attributes:",d)}function l(u){let v=0,d=Date.now(),b=Array.from(u.getElementsByTagName("br")),h=[],C=()=>{if(h.length>2)for(let S=2;S<h.length;S++)h[S].remove(),v++;h=[]};b.forEach((S=>{var k;let M=!1;if(h.length>0){let $=h[h.length-1],q=S.previousSibling;for(;q&&(0,e.isTextNode)(q)&&!(!((k=q.textContent)===null||k===void 0)&&k.trim());)q=q.previousSibling;q===$&&(M=!0)}M?h.push(S):(C(),h=[S])})),C();let E=Date.now();(0,e.logDebug)("Standardized br elements:",{removed:v,processingTime:`${(E-d).toFixed(2)}ms`})}function c(u,v){let d=0,b=Date.now(),h=!0;function C(s){var x;for(let y of s.childNodes)if((0,e.isTextNode)(y)&&(!((x=y.textContent)===null||x===void 0)&&x.trim())||(0,e.isElement)(y)&&f.INLINE_ELEMENTS.has(y.nodeName.toLowerCase()))return!0;return!1}let E=s=>{let x=s.tagName.toLowerCase();if(f.PRESERVE_ELEMENTS.has(x))return!0;let y=s.getAttribute("role");if(y&&["article","main","navigation","banner","contentinfo"].includes(y))return!0;let T=s.className;return typeof T=="string"&&T.toLowerCase().match(/(?:article|main|content|footnote|reference|bibliography)/)?!0:!!Array.from(s.children).some((L=>f.PRESERVE_ELEMENTS.has(L.tagName.toLowerCase())||L.getAttribute("role")==="article"||L.className&&typeof L.className=="string"&&L.className.toLowerCase().match(/(?:article|main|content|footnote|reference|bibliography)/)))},S=s=>{var x;if(C(s))return!1;if(!(!((x=s.textContent)===null||x===void 0)&&x.trim()))return!0;let y=Array.from(s.children);if(y.length===0||y.every((N=>{let A=N.tagName.toLowerCase();return f.BLOCK_ELEMENTS.includes(A)||A==="p"||A==="h1"||A==="h2"||A==="h3"||A==="h4"||A==="h5"||A==="h6"||A==="ul"||A==="ol"||A==="pre"||A==="blockquote"||A==="figure"})))return!0;let T=s.className.toLowerCase();return/(?:wrapper|container|layout|row|col|grid|flex|outer|inner|content-area)/i.test(T)||Array.from(s.childNodes).filter((N=>{var A;return(0,e.isTextNode)(N)&&((A=N.textContent)===null||A===void 0?void 0:A.trim())})).length===0?!0:!(!(y.length>0)||y.some((N=>{let A=N.tagName.toLowerCase();return f.INLINE_ELEMENTS.has(A)})))},k=s=>{var x,y;if(!s.isConnected||E(s))return!1;let T=s.tagName.toLowerCase();if(!f.ALLOWED_EMPTY_ELEMENTS.has(T)&&!s.children.length&&!(!((x=s.textContent)===null||x===void 0)&&x.trim()))return s.remove(),d++,!0;if(s.parentElement===u){let _=Array.from(s.children);if(_.length>0&&!_.some((O=>{let H=O.tagName.toLowerCase();return f.INLINE_ELEMENTS.has(H)}))){let O=v.createDocumentFragment();for(;s.firstChild;)O.appendChild(s.firstChild);return s.replaceWith(O),d++,!0}}if(S(s)){if(!Array.from(s.children).some((O=>{let H=O.tagName.toLowerCase();return f.INLINE_ELEMENTS.has(H)}))){let O=v.createDocumentFragment();for(;s.firstChild;)O.appendChild(s.firstChild);return s.replaceWith(O),d++,!0}let _=v.createDocumentFragment();for(;s.firstChild;)_.appendChild(s.firstChild);return s.replaceWith(_),d++,!0}let L=Array.from(s.childNodes);if(L.length>0&&L.every((_=>(0,e.isTextNode)(_)||(0,e.isElement)(_)&&f.INLINE_ELEMENTS.has(_.nodeName.toLowerCase())))&&(!((y=s.textContent)===null||y===void 0)&&y.trim())){let _=v.createElement("p");for(;s.firstChild;)_.appendChild(s.firstChild);return s.replaceWith(_),d++,!0}if(s.children.length===1){let _=s.firstElementChild,O=_.tagName.toLowerCase();if(f.BLOCK_ELEMENTS.includes(O)&&!E(_))return s.replaceWith(_),d++,!0}let N=0,A=s.parentElement;for(;A;){let _=A.tagName.toLowerCase();f.BLOCK_ELEMENTS.includes(_)&&N++,A=A.parentElement}if(N>0&&!C(s)){let _=v.createDocumentFragment();for(;s.firstChild;)_.appendChild(s.firstChild);return s.replaceWith(_),d++,!0}return!1},M=()=>{let s=Array.from(u.children).filter((y=>f.BLOCK_ELEMENTS.includes(y.tagName.toLowerCase()))),x=!1;return s.forEach((y=>{k(y)&&(x=!0)})),x},$=()=>{let s=Array.from(u.querySelectorAll(f.BLOCK_ELEMENTS.join(","))).sort(((y,T)=>{let L=N=>{let A=0,_=N.parentElement;for(;_;){let O=_.tagName.toLowerCase();f.BLOCK_ELEMENTS.includes(O)&&A++,_=_.parentElement}return A};return L(T)-L(y)})),x=!1;return s.forEach((y=>{k(y)&&(x=!0)})),x},q=()=>{let s=Array.from(u.querySelectorAll(f.BLOCK_ELEMENTS.join(","))),x=!1;return s.forEach((y=>{let T=Array.from(y.children);if(T.length>0&&T.every((L=>L.tagName.toLowerCase()==="p"))||!E(y)&&S(y)){let L=v.createDocumentFragment();for(;y.firstChild;)L.appendChild(y.firstChild);y.replaceWith(L),d++,x=!0}})),x};do h=!1,M()&&(h=!0),$()&&(h=!0),q()&&(h=!0);while(h);let j=Date.now();(0,e.logDebug)("Flattened wrapper elements:",{count:d,processingTime:`${(j-b).toFixed(2)}ms`})}},864:(I,g,m)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.headingRules=void 0;let f=m(640);g.headingRules=[{selector:"h1, h2, h3, h4, h5, h6",element:"keep",transform:p=>{var w;let t=p.ownerDocument;if(!t)return console.warn("No document available"),p;let o=t.createElement(p.tagName);Array.from(p.attributes).forEach((i=>{f.ALLOWED_ATTRIBUTES.has(i.name)&&o.setAttribute(i.name,i.value)}));let r=p.cloneNode(!0),e=new Map;Array.from(r.querySelectorAll("*")).forEach((i=>{var a,l,c,u,v,d;let b=!1;if(i.tagName.toLowerCase()==="a"){let h=i.getAttribute("href");(h?.includes("#")||h?.startsWith("#"))&&(e.set(i,((a=i.textContent)===null||a===void 0?void 0:a.trim())||""),b=!0)}if(i.classList.contains("anchor")&&(e.set(i,((l=i.textContent)===null||l===void 0?void 0:l.trim())||""),b=!0),i.tagName.toLowerCase()==="button"&&(b=!0),(i.tagName.toLowerCase()==="span"||i.tagName.toLowerCase()==="div")&&i.querySelector('a[href^="#"]')){let h=i.querySelector('a[href^="#"]');h&&e.set(i,((c=h.textContent)===null||c===void 0?void 0:c.trim())||""),b=!0}if(b){let h=i.parentElement;h&&h!==r&&((u=h.textContent)===null||u===void 0?void 0:u.trim())===((v=i.textContent)===null||v===void 0?void 0:v.trim())&&e.set(h,((d=i.textContent)===null||d===void 0?void 0:d.trim())||"")}})),Array.from(r.querySelectorAll("*")).filter((i=>{if(i.tagName.toLowerCase()==="a"){let a=i.getAttribute("href");return a?.includes("#")||a?.startsWith("#")}return!!i.classList.contains("anchor")||i.tagName.toLowerCase()==="button"||!(i.tagName.toLowerCase()!=="span"&&i.tagName.toLowerCase()!=="div"||!i.querySelector('a[href^="#"]'))})).forEach((i=>i.remove()));let n=((w=r.textContent)===null||w===void 0?void 0:w.trim())||"";return!n&&e.size>0&&(n=Array.from(e.values())[0]),o.textContent=n,o}}]},917:(I,g,m)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.ExtractorRegistry=void 0;let f=m(959),p=m(248),w=m(258),t=m(458),o=m(632),r=m(397),e=m(20),n=m(732),i=m(588);class a{static initialize(){this.register({patterns:["twitter.com",/\/x\.com\/.*/],extractor:p.TwitterExtractor}),this.register({patterns:["reddit.com","old.reddit.com","new.reddit.com",/^https:\/\/[^\/]+\.reddit\.com/],extractor:f.RedditExtractor}),this.register({patterns:["youtube.com","youtu.be",/youtube\.com\/watch\?v=.*/,/youtu\.be\/.*/],extractor:w.YoutubeExtractor}),this.register({patterns:[/news\.ycombinator\.com\/item\?id=.*/],extractor:t.HackerNewsExtractor}),this.register({patterns:[/^https?:\/\/chatgpt\.com\/(c|share)\/.*/],extractor:o.ChatGPTExtractor}),this.register({patterns:[/^https?:\/\/claude\.ai\/(chat|share)\/.*/],extractor:r.ClaudeExtractor}),this.register({patterns:[/^https?:\/\/grok\.com\/(chat|share)(\/.*)?$/],extractor:e.GrokExtractor}),this.register({patterns:[/^https?:\/\/gemini\.google\.com\/app\/.*/],extractor:n.GeminiExtractor}),this.register({patterns:["github.com",/^https?:\/\/github\.com\/.*/],extractor:i.GitHubExtractor})}static register(c){this.mappings.push(c)}static findExtractor(c,u,v){try{let d=new URL(u).hostname;if(this.domainCache.has(d)){let b=this.domainCache.get(d);return b?new b(c,u,v):null}for(let{patterns:b,extractor:h}of this.mappings)if(b.some((C=>C instanceof RegExp?C.test(u):d.includes(C))))return this.domainCache.set(d,h),new h(c,u,v);return this.domainCache.set(d,null),null}catch(d){return console.error("Error in findExtractor:",d),null}}static clearCache(){this.domainCache.clear()}}g.ExtractorRegistry=a,a.mappings=[],a.domainCache=new Map,a.initialize()},959:(I,g,m)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.RedditExtractor=void 0;let f=m(279);class p extends f.BaseExtractor{constructor(t,o){super(t,o),this.shredditPost=t.querySelector("shreddit-post")}canExtract(){return!!this.shredditPost}extract(){var t,o;let r=this.getPostContent(),e=this.extractComments(),n=this.createContentHtml(r,e),i=((o=(t=this.document.querySelector("h1"))===null||t===void 0?void 0:t.textContent)===null||o===void 0?void 0:o.trim())||"",a=this.getSubreddit(),l=this.getPostAuthor(),c=this.createDescription(r);return{content:n,contentHtml:n,extractedContent:{postId:this.getPostId(),subreddit:a,postAuthor:l},variables:{title:i,author:l,site:`r/${a}`,description:c}}}getPostContent(){var t,o,r,e;return(((o=(t=this.shredditPost)===null||t===void 0?void 0:t.querySelector('[slot="text-body"]'))===null||o===void 0?void 0:o.innerHTML)||"")+(((e=(r=this.shredditPost)===null||r===void 0?void 0:r.querySelector("#post-image"))===null||e===void 0?void 0:e.outerHTML)||"")}createContentHtml(t,o){return`
			<div class="reddit-post">
				<div class="post-content">
					${t}
				</div>
			</div>
			${o?`
				<hr>
				<h2>Comments</h2>
				<div class="reddit-comments">
					${o}
				</div>
			`:""}
		`.trim()}extractComments(){let t=Array.from(this.document.querySelectorAll("shreddit-comment"));return this.processComments(t)}getPostId(){let t=this.url.match(/comments\/([a-zA-Z0-9]+)/);return t?.[1]||""}getSubreddit(){let t=this.url.match(/\/r\/([^/]+)/);return t?.[1]||""}getPostAuthor(){var t;return((t=this.shredditPost)===null||t===void 0?void 0:t.getAttribute("author"))||""}createDescription(t){var o;if(!t)return"";let r=document.createElement("div");return r.innerHTML=t,((o=r.textContent)===null||o===void 0?void 0:o.trim().slice(0,140).replace(/\s+/g," "))||""}processComments(t){var o;let r="",e=-1,n=[];for(let i of t){let a=parseInt(i.getAttribute("depth")||"0"),l=i.getAttribute("author")||"",c=i.getAttribute("score")||"0",u=i.getAttribute("permalink")||"",v=((o=i.querySelector('[slot="comment"]'))===null||o===void 0?void 0:o.innerHTML)||"",d=i.querySelector("faceplate-timeago"),b=d?.getAttribute("ts")||"",h=b?new Date(b).toISOString().split("T")[0]:"";if(a===0){for(;n.length>0;)r+="</blockquote>",n.pop();r+="<blockquote>",n=[0],e=0}else if(a<e)for(;n.length>0&&n[n.length-1]>=a;)r+="</blockquote>",n.pop();else a>e&&(r+="<blockquote>",n.push(a));r+=`<div class="comment">
	<div class="comment-metadata">
		<span class="comment-author"><strong>${l}</strong></span> \u2022
		<a href="https://reddit.com${u}" class="comment-link">${c} points</a> \u2022
		<span class="comment-date">${h}</span>
	</div>
	<div class="comment-content">${v}</div>
</div>`,e=a}for(;n.length>0;)r+="</blockquote>",n.pop();return r}}g.RedditExtractor=p},968:(I,g,m)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.ContentScorer=void 0;let f=m(640),p=["admonition","article","content","entry","image","img","font","figure","figcaption","pre","main","post","story","table"],w=["advertisement","all rights reserved","banner","cookie","comments","copyright","follow me","follow us","footer","header","homepage","login","menu","more articles","more like this","most read","nav","navigation","newsletter","newsletter","popular","privacy","recommended","register","related","responses","share","sidebar","sign in","sign up","signup","social","sponsored","subscribe","subscribe","terms","trending"],t=["ad","banner","cookie","copyright","footer","header","homepage","menu","nav","newsletter","popular","privacy","recommended","related","rights","share","sidebar","social","sponsored","subscribe","terms","trending","widget"];class o{constructor(e,n=!1){this.doc=e,this.debug=n}static scoreElement(e){let n=0,i=e.textContent||"",a=i.split(/\s+/).length;n+=a,n+=10*e.getElementsByTagName("p").length,n-=5*(e.getElementsByTagName("a").length/(a||1)),n-=3*(e.getElementsByTagName("img").length/(a||1));try{let c=e.getAttribute("style")||"",u=e.getAttribute("align")||"";(c.includes("float: right")||c.includes("text-align: right")||u==="right")&&(n+=5)}catch{}/\b(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)[a-z]*\s+\d{1,2},?\s+\d{4}\b/i.test(i)&&(n+=10),/\b(?:by|written by|author:)\s+[A-Za-z\s]+\b/i.test(i)&&(n+=10);let l=e.className.toLowerCase();if((l.includes("content")||l.includes("article")||l.includes("post"))&&(n+=15),e.querySelector(f.FOOTNOTE_INLINE_REFERENCES)&&(n+=10),e.querySelector(f.FOOTNOTE_LIST_SELECTORS)&&(n+=10),n-=5*e.getElementsByTagName("table").length,e.tagName.toLowerCase()==="td"){let c=e.closest("table");if(c){let u=parseInt(c.getAttribute("width")||"0"),v=c.getAttribute("align")||"",d=c.className.toLowerCase();if(u>400||v==="center"||d.includes("content")||d.includes("article")){let b=Array.from(c.getElementsByTagName("td")),h=b.indexOf(e);h>0&&h<b.length-1&&(n+=10)}}}return n}static findBestElement(e,n=50){let i=null,a=0;return e.forEach((l=>{let c=this.scoreElement(l);c>a&&(a=c,i=l)})),a>n?i:null}static scoreAndRemove(e,n=!1){let i=Date.now(),a=0,l=new Set;Array.from(e.querySelectorAll(f.BLOCK_ELEMENTS.join(","))).forEach((u=>{l.has(u)||o.isLikelyContent(u)||o.scoreNonContentBlock(u)<0&&(l.add(u),a++)})),l.forEach((u=>u.remove()));let c=Date.now();n&&console.log("Defuddle","Removed non-content blocks:",{count:a,processingTime:`${(c-i).toFixed(2)}ms`})}static isLikelyContent(e){let n=e.getAttribute("role");if(n&&["article","main","contentinfo"].includes(n))return!0;let i=e.className.toLowerCase(),a=e.id.toLowerCase();for(let u of p)if(i.includes(u)||a.includes(u))return!0;let l=(e.textContent||"").split(/\s+/).length,c=e.getElementsByTagName("p").length;return l>50&&c>1||l>100||l>30&&c>0}static scoreNonContentBlock(e){if(e.querySelector(f.FOOTNOTE_LIST_SELECTORS))return 0;let n=0,i=e.textContent||"",a=i.split(/\s+/).length;if(a<3)return 0;for(let d of w)i.toLowerCase().includes(d)&&(n-=10);let l=e.getElementsByTagName("a").length;l/(a||1)>.5&&(n-=15);let c=e.getElementsByTagName("ul").length+e.getElementsByTagName("ol").length;c>0&&l>3*c&&(n-=10);let u=e.className.toLowerCase(),v=e.id.toLowerCase();for(let d of t)(u.includes(d)||v.includes(d))&&(n-=8);return n}}g.ContentScorer=o}},F={};function G(I){var g=F[I];if(g!==void 0)return g.exports;var m=F[I]={exports:{}};return U[I](m,m.exports,G),m.exports}var z={};return(()=>{var I=z;let g=G(628);I.default=g.Defuddle})(),z=z.default})()))});var lt=st(Q());window.Defuddle=lt;})();
